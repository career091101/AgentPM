# ワークフロー vs AgentSkills 統合分析

## 現状の2つのシステム

### 1. スラッシュコマンド（ワークフロー）
**場所**: `.agent/workflows/orchestrate_phase1.md`

**役割**: **「How to Execute（実行手順）」**
- 16ステップの実行順序を定義
- 各ステップで呼び出すワークフロー名を指定（例: `/discover_idea`, `/create_lean_canvas`）
- フォルダ構造、ファイル命名規則を定義
- エラーハンドリング、リトライロジックを記述

**例**:
```markdown
STEP 1: /discover_idea → business_idea.md
STEP 2: /create_lean_canvas → lean_canvas.md
STEP 3: /define_persona → persona.md
```

---

### 2. AgentSkills.md
**場所**: `projects/Founder_Agent_Phase1/AgentSkills.md`

**役割**: **「What to Achieve（品質基準）」**
- 27ルール、10セクションの制約条件
- 成果物に含めるべき要素を定義（例: TAM/SAM/SOM、3U+1検証、10倍優位性）
- 品質基準を宣言的に記述
- Executorが遵守すべきチェックリスト

**例**:
```markdown
- [ ] 市場規模はTAM/SAM/SOMの3層で定量化せよ
- [ ] 課題は3U+1で検証可能な形式で記述せよ
- [ ] 10倍優位性を最低2軸で達成せよ
```

---

## 両者の関係性

```
┌─────────────────────────────────────────┐
│  orchestrate_phase1.md（ワークフロー）   │
│  「実行順序・手続き」                    │
│                                         │
│  STEP 1: /discover_idea                │
│  STEP 2: /create_lean_canvas           │
│  STEP 3: /define_persona               │
│  ...                                    │
└─────────────┬───────────────────────────┘
              │ 各ステップで参照
              ↓
┌─────────────────────────────────────────┐
│  AgentSkills.md（制約条件）              │
│  「品質基準・チェックリスト」             │
│                                         │
│  ✅ TAM/SAM/SOM定量化                   │
│  ✅ 3U+1検証                            │
│  ✅ 10倍優位性2軸以上                   │
│  ...                                    │
└─────────────────────────────────────────┘
```

**現在の設計思想**:
- ワークフロー: 「どの順番で何を実行するか」
- AgentSkills: 「各ステップで何を満たすべきか」

---

## 統合案: AgentSkills.mdだけにする

### 統合方法

AgentSkills.mdにワークフローの実行手順も含める形に統合。

**統合後のAgentSkills.md構造案**:
```markdown
# AgentSkills - Founder Agent Phase1

## セクションA: 実行フロー（ワークフロー統合）

### STEP -1: フォルダ初期化
- [ ] ideas/内の既存フォルダから次のIDを自動採番せよ
- [ ] アイデア名をケバブケース化（英字20文字以内）せよ
- [ ] {ID}_{NAME}フォルダを作成せよ

### STEP 0: 5つの眼分析
- [ ] 鳥の眼（マクロ視点）で市場全体を俯瞰せよ
- [ ] 虫の眼（ミクロ視点）で顧客の具体的行動を観察せよ
- [ ] 魚の眼（トレンド）でメガトレンドを特定せよ
...

### STEP 2: リーンキャンバス作成
- [ ] リーンキャンバス9ブロック全てを記載せよ
- [ ] TAM/SAM/SOMを定量化せよ
- [ ] 3U+1検証を実施せよ
...

## セクション1: 市場分析ルール（品質基準）
- [ ] 市場規模はTAM/SAM/SOMの3層で定量化せよ
- [ ] 各市場規模の算出根拠（ソース名、計算式）を明記せよ
...

## セクション2: 顧客理解ルール
...
```

---

## メリット・デメリット分析

### ✅ メリット

#### 1. **一元管理の実現**
- 実行手順と品質基準が1ファイルで完結
- 参照先を探す手間がなくなる
- メンテナンス箇所が1箇所に集約

#### 2. **学習コストの低下**
- 新規メンバーが学ぶファイルが1つで済む
- 「ワークフローとAgentSkillsの違い」を理解する必要がなくなる

#### 3. **AgentSkills.mdの自己完結性向上**
- AgentSkills.mdだけで全体像が把握できる
- ワークフローファイルを探さなくても実行可能

#### 4. **Updaterの更新範囲明確化**
- Updaterが更新するファイルが1つに絞られる
- 「ワークフローも更新すべきか？」の判断不要

---

### ❌ デメリット

#### 1. **関心の分離（Separation of Concerns）の喪失**
- 「実行手順（How）」と「品質基準（What）」が混在
- ファイルの肥大化（現在27ルール → 50ルール以上になる可能性）
- 可読性の低下

#### 2. **再利用性の低下**
- AgentSkills.mdは「Phase1専用」になる
- Phase2、Phase3で異なるワークフローが必要な場合、別ファイルが必要
- 品質基準（セクション1-10）は再利用したいが、実行手順は異なる

#### 3. **柔軟性の低下**
- ワークフローの変更（ステップの追加・削除）時にAgentSkills.mdを編集
- Reviewersが指摘した品質基準とワークフロー変更が混在し、更新履歴が複雑化

#### 4. **役割の曖昧化**
- 「AgentSkills = 品質基準」という明確な定義が崩れる
- 「実行手順もスキルなのか？」という概念的混乱

#### 5. **既存の成功したアーキテクチャの破壊**
- 現在のTest 1-5で100%成功している設計を変更するリスク
- 階層型ハイブリッドアーキテクチャ（Orchestrator → Controller → Executor）の崩壊

---

## 推奨案: **現状維持（2ファイル体制）**

### 理由

#### 1. **既に成功している設計**
- Test 1-5で100%成功
- 実際のマルチエージェント実行で検証済み
- 「壊れていないものを修正しない」原則

#### 2. **関心の分離の利点**
- ワークフロー: Orchestrator/Controllerが参照
- AgentSkills: Executorが参照
- 役割が明確で、各エージェントが必要な情報だけを参照

#### 3. **再利用性の維持**
- AgentSkills.md（品質基準）はPhase2、Phase3でも再利用可能
- orchestrate_phase2.mdでは異なるステップだが、同じ品質基準を適用

#### 4. **拡張性の確保**
- 新しいワークフローを追加しても、AgentSkills.mdは不変
- 品質基準の変更はワークフローに影響しない

---

## 妥協案: **軽微な改善で統合感を高める**

完全統合ではなく、以下の改善で「実質的な統合感」を実現：

### 改善1: 相互参照の明確化

**orchestrate_phase1.md**に追記:
```markdown
## 品質基準
全ステップの成果物は以下の品質基準を遵守する：
- 参照: `AgentSkills.md`（27ルール、10セクション）
```

**AgentSkills.md**に追記:
```markdown
## 実行フロー参照
このスキルセットは以下のワークフローで使用される：
- `orchestrate_phase1.md`（Phase1: アイデア発見→MVP公開）
- `orchestrate_phase2.md`（Phase2: PMF検証）
```

### 改善2: AgentSkills.mdにステップマッピング追記

各セクションにどのステップで使用されるかを明記:

```markdown
## 1. 市場分析ルール
**使用ステップ**: STEP 0, 2, 5

- [ ] 市場規模はTAM/SAM/SOMの3層で定量化せよ
- [ ] 各市場規模の算出根拠を明記せよ
...
```

### 改善3: ワークフローにチェックリスト参照追記

```markdown
### STEP 2: /create_lean_canvas
**出力**: lean_canvas.md
**品質基準**:
- AgentSkills.md セクション1（市場分析）
- AgentSkills.md セクション2（顧客理解）
- AgentSkills.md セクション3（課題定義）
- AgentSkills.md セクション4（ソリューション）
- AgentSkills.md セクション5（競合・差別化）
- AgentSkills.md セクション6（ビジネスモデル）
```

---

## 比較表

| 項目 | 現状（2ファイル） | 完全統合（1ファイル） | 妥協案（軽微改善） |
|------|----------------|------------------|-----------------|
| ファイル数 | 2 | 1 | 2 |
| 関心の分離 | ✅ 明確 | ❌ 混在 | ✅ 明確 |
| 学習コスト | ⚠️ やや高 | ✅ 低 | ⚠️ やや高 |
| 再利用性 | ✅ 高 | ❌ 低 | ✅ 高 |
| メンテナンス性 | ✅ 高 | ⚠️ 中 | ✅ 高 |
| 可読性 | ✅ 高 | ❌ 低（肥大化） | ✅ 高 |
| 現在の成功を維持 | ✅ はい | ❌ リスクあり | ✅ はい |

---

## 最終推奨

### **推奨**: 妥協案（軽微改善）

**理由**:
1. 現在のTest 1-5で100%成功している設計を維持
2. 相互参照の明確化で「実質的な統合感」を実現
3. 関心の分離を保ちつつ、学習コストを下げる

**実装内容**:
- orchestrate_phase1.mdに品質基準参照を明記
- AgentSkills.mdに使用ステップマッピングを追加
- 両ファイルの冒頭に相互参照リンクを追加

**実装時間**: 15分程度

---

## ユーザー判断のための質問

以下の質問にお答えいただくと、最適な選択肢をご提案できます：

1. **優先したいのはどれですか？**
   - A. ファイル数を減らしたい（学習コスト重視）
   - B. 成功している設計を維持したい（安定性重視）
   - C. 実質的な統合感があればよい（バランス重視）

2. **Phase2、Phase3でも同じ品質基準を使いますか？**
   - Yes → AgentSkills.mdは独立させるべき
   - No → 統合しても問題ない

3. **ファイルの肥大化（50ルール以上）は許容できますか？**
   - Yes → 完全統合可能
   - No → 現状維持または妥協案

---

**作成日**: 2025-12-29
**分析者**: Claude Code
