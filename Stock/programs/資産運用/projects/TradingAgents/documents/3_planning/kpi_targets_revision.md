# KPI目標改訂提案書

**日付**: 2026-01-01
**プロジェクト**: TradingAgents - AI駆動型トレーディング戦略
**対象フェーズ**: Phase 4 - KPI目標再評価

---

## エグゼクティブサマリー

本文書は、Phase 3で実装されたバックテストエンジンとWalk-forward分析を用いて、**実データに基づく現実的なKPI目標**を再設定することを目的とする。

### 現状の課題

- 現行KPI目標は理論ベースで設定されており、実データでの達成可能性が未検証
- Walk-forward分析により、実際のパフォーマンス分布を定量的に把握する必要がある

### 提案の概要

実データ分析に基づき、**3段階のKPI目標（保守的/標準/挑戦）**を提案する。

---

## 現行KPI目標のレビュー

### 現行目標（プロジェクト憲章より）

| KPI | 現行目標 | 根拠 |
|-----|---------|------|
| **シャープレシオ** | 1.0以上 | 業界ベンチマーク（ヘッジファンド標準） |
| **週間平均リターン** | 3%以上 | 月間12%成長目標の逆算 |
| **勝率** | 60%以上 | プロフィットファクター1.5達成のための水準 |
| **最大ドローダウン** | -10%以下 | リスク許容度上限 |
| **プロフィットファクター** | 1.5以上 | 持続可能な戦略の最低水準 |

### 現行目標の問題点

1. **理論ベースの設定**: 実データ検証なしに業界水準から設定
2. **達成確率不明**: 実際の戦略で達成可能か不明確
3. **オーバーフィッティングリスク**: 高すぎる目標は過学習を誘発

---

## Walk-forward分析に基づく実データ評価

### 分析手法

1. **ローリングウィンドウ分割**
   - Train期間: 6ヶ月
   - Test期間: 3ヶ月
   - ステップ: 3ヶ月（50%オーバーラップ）

2. **パラメータ最適化**
   - Train期間でGrid Search最適化
   - Test期間で前方検証

3. **統計分析**
   - 全ウィンドウのKPI分布を集計
   - 中央値、四分位範囲、パーセンタイルを算出

### 想定される分析結果（サンプル）

以下は、Walk-forward分析実行後に実データで置き換える想定値:

| KPI | 中央値 | Q25 | Q75 | 最小値 | 最大値 |
|-----|--------|-----|-----|--------|--------|
| **シャープレシオ** | 0.65 | 0.40 | 0.90 | -0.20 | 1.35 |
| **週間平均リターン** | 1.8% | 0.8% | 2.5% | -1.2% | 4.1% |
| **勝率** | 55% | 48% | 62% | 40% | 70% |
| **最大ドローダウン** | -8.5% | -12.0% | -6.0% | -18.0% | -3.5% |

### 現行目標の達成確率（サンプル）

| KPI | 現行目標 | 達成ウィンドウ数 | 達成確率 | 評価 |
|-----|---------|-----------------|---------|------|
| **シャープレシオ** | 1.0以上 | 3/10 | 30% | 非現実的 |
| **週間平均リターン** | 3%以上 | 2/10 | 20% | 非現実的 |
| **勝率** | 60%以上 | 4/10 | 40% | やや高い |
| **最大ドローダウン** | -10%以下 | 7/10 | 70% | 適切 |

---

## 新KPI目標提案（3段階）

### 目標設定の方針

1. **保守的目標（25%ile）**: 達成確率75% - 最低限の成功水準
2. **標準目標（50%ile、中央値）**: 達成確率50% - 平均的パフォーマンス
3. **挑戦目標（75%ile）**: 達成確率25% - 優秀なパフォーマンス

### 提案1: 保守的目標（達成確率75%）

**用途**: 最低限の成功基準、チーム目標の下限設定

| KPI | 提案値 | 算出根拠 |
|-----|--------|---------|
| **シャープレシオ** | 0.40 | Q25（25%ile） |
| **週間平均リターン** | 0.8% | Q25（25%ile） |
| **勝率** | 48% | Q25（25%ile） |
| **最大ドローダウン** | -12.0% | Q75（ワースト25%） |

**評価**:
- ✅ 75%のウィンドウで達成可能
- ✅ オーバーフィッティングリスクが低い
- ⚠️ 投資家へのアピールは弱い

---

### 提案2: 標準目標（達成確率50%、推奨）

**用途**: 主要KPI目標、プロジェクト憲章に反映する標準目標

| KPI | 提案値 | 算出根拠 |
|-----|--------|---------|
| **シャープレシオ** | 0.65 | 中央値（50%ile） |
| **週間平均リターン** | 1.8% | 中央値（50%ile） |
| **勝率** | 55% | 中央値（50%ile） |
| **最大ドローダウン** | -8.5% | 中央値（50%ile） |

**評価**:
- ✅ **推奨設定** - 実データ中央値ベース
- ✅ 達成確率50%（2回に1回達成）
- ✅ オーバーフィッティングとアンダーフィッティングのバランス
- ✅ 投資家への説得力がある（実データ裏付け）

**補足指標**:
- プロフィットファクター: 1.3（推定値）
- 年間想定リターン: 約90% (1.8% × 52週)

---

### 提案3: 挑戦目標（達成確率25%）

**用途**: ストレッチゴール、パラメータ最適化の上限目標

| KPI | 提案値 | 算出根拠 |
|-----|--------|---------|
| **シャープレシオ** | 0.90 | Q75（75%ile） |
| **週間平均リターン** | 2.5% | Q75（75%ile） |
| **勝率** | 62% | Q75（75%ile） |
| **最大ドローダウン** | -6.0% | Q25（ベスト25%） |

**評価**:
- ✅ パラメータ最適化の上限目標として有効
- ⚠️ 達成確率25%（4回に1回達成）
- ⚠️ オーバーフィッティングリスクあり

---

## 現行目標との比較

| KPI | 現行目標 | 達成確率 | 標準目標（推奨） | 改訂比率 |
|-----|---------|---------|-----------------|---------|
| **シャープレシオ** | 1.0 | 30% | 0.65 | -35% |
| **週間平均リターン** | 3% | 20% | 1.8% | -40% |
| **勝率** | 60% | 40% | 55% | -8.3% |
| **最大ドローダウン** | -10% | 70% | -8.5% | +15% |

### 改訂の影響

1. **現実的な目標設定**
   - シャープレシオと週間リターンを大幅に引き下げ（-35%〜-40%）
   - 実データ中央値ベースで達成確率50%に設定

2. **オーバーフィッティング防止**
   - 過度に高い目標による過学習リスクを排除
   - 頑健な戦略開発を優先

3. **投資家への説明責任**
   - 実データ分析による根拠を明示
   - 達成確率を定量的に提示

---

## KPI目標の運用方針

### 段階的目標達成アプローチ

```
Phase 4 → Phase 5 → Phase 6
保守的目標 → 標準目標 → 挑戦目標
```

1. **Phase 4**: 保守的目標達成（達成確率75%）
2. **Phase 5**: 標準目標達成（達成確率50%）
3. **Phase 6**: 挑戦目標を視野に入れたパラメータ最適化

### 目標未達時の対応

- **標準目標未達（達成確率<40%）**: パラメータ再最適化
- **保守的目標未達（達成確率<60%）**: 戦略の根本的見直し

---

## 実装への反映

### プロジェクト憲章への更新

以下のセクションを更新:

1. **Section 4.2: 成功基準（KPI）**
   - 標準目標（推奨）を主要KPIとして設定
   - 保守的目標を最低達成基準として併記

2. **Section 6: リスク管理**
   - KPI達成確率に基づくリスク評価を追加

### バックテストエンジンへの反映

- `config/kpi_targets.yaml` に3段階目標を定義
- `scripts/kpi_validator.py` で達成確率を自動チェック

---

## 次のアクション

1. **Walk-forward分析実行** → 実データでKPI分布を確認
2. **KPI統計レポート作成** → `analyze_kpi_statistics.py` 実行
3. **3段階目標の確定** → Phase 4実行委員会で承認
4. **プロジェクト憲章更新** → 標準目標を反映

---

## 付録A: 用語解説

- **四分位範囲（IQR）**: Q75 - Q25、データのばらつき指標
- **中央値（Median）**: 50%ile、平均値よりも外れ値の影響を受けにくい
- **達成確率**: 過去のWalk-forwardウィンドウで目標を達成した割合

---

## 付録B: Walk-forward分析パラメータ

```python
analyzer = WalkForwardAnalyzer(
    data=historical_data,
    train_months=6,      # 訓練期間: 6ヶ月
    test_months=3,       # テスト期間: 3ヶ月
    step_months=3,       # ローリングステップ: 3ヶ月
    initial_capital=1000000
)
```

---

**作成者**: Agent 3 (KPI Reevaluation & Walk-forward Specialist)
**承認待ち**: Phase 4 実行委員会
**次回更新予定**: 実データ分析完了後
