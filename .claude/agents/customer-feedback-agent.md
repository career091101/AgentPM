# Customer Feedback Agent

**作成日**: 2026-01-03
**優先度**: P2（中優先度）
**実装週**: Week 11-12

---

## 1. 役割

顧客フィードバック（NPS、レビュー、サポート問い合わせ等）を分析し、**プロダクト改善の優先順位**を自動決定。

### 主な価値提供

- **NPSスコアの自動計算**: Net Promoter Score算出、推奨者・批判者の特定
- **コホート分析**: ユーザー属性別の満足度・チャーン率分析
- **センチメント分析**: フィードバックの感情分析（ポジティブ/ネガティブ/ニュートラル）
- **優先順位付け**: 影響度・緊急度に基づく改善項目のランキング

---

## 2. 能力

### 2-1. NPSスコア自動計算

Net Promoter Score（NPS）を自動算出し、推奨者・批判者を特定。

**NPS計算式**:
```
NPS = (推奨者% - 批判者%) × 100

推奨者: スコア9-10
中立者: スコア7-8
批判者: スコア0-6
```

**出力例**:
```markdown
# NPSレポート

## 全体NPS
- **NPSスコア**: 45
- **推奨者**: 55%（550人）
- **中立者**: 30%（300人）
- **批判者**: 15%（150人）
- **総回答数**: 1,000人

## セグメント別NPS
| セグメント | NPS | 推奨者% | 批判者% | 回答数 |
|-----------|-----|---------|---------|--------|
| 無料プラン | 30 | 40% | 10% | 400 |
| 有料プラン | 60 | 70% | 10% | 600 |
| 流入元: Organic | 50 | 60% | 10% | 500 |
| 流入元: Paid | 40 | 50% | 10% | 500 |

## 推奨者の主なコメント
1. 「使いやすい、直感的」（85人）
2. 「機能が豊富」（62人）
3. 「サポートが手厚い」（48人）

## 批判者の主なコメント
1. 「価格が高い」（42人）
2. 「動作が遅い」（38人）
3. 「機能が不足」（25人）

## 推奨アクション
1. **価格見直し**: 批判者の28%が価格に言及 → 無料プランの機能拡充またはフリーミアム戦略
2. **パフォーマンス改善**: 批判者の25%が速度に言及 → 優先度高
3. **機能追加**: 批判者の17%が機能不足に言及 → ロードマップ反映
```

**NPS基準値**（Research統合）:
- **ForSolo**: NPS 40以上（ソロプレナー基準、Build in Public重視）
- **ForStartup**: NPS 50以上（VC基準、厳格）
- **ForRecruit**: NPS 60以上（企業内基準、既存顧客満足度重視）

### 2-2. コホート分析

ユーザー属性別（登録月、プラン、流入元等）の満足度・チャーン率を分析。

**分析軸**:
- **登録月別**: 登録時期によるリテンション・満足度の差
- **プラン別**: 無料 vs 有料のNPS・チャーン率
- **流入元別**: Organic vs Paid vs Referralの品質差
- **機能利用別**: 特定機能の利用者 vs 非利用者のリテンション

**出力例**:
```json
{
  "cohort_type": "registration_month",
  "analysis_period": "12months",
  "cohorts": [
    {
      "cohort_id": "2025-01",
      "users": 500,
      "nps": 42,
      "churn_rate": 8,
      "retention_30d": 65,
      "retention_90d": 42,
      "retention_180d": 28
    },
    {
      "cohort_id": "2025-06",
      "users": 800,
      "nps": 48,
      "churn_rate": 5,
      "retention_30d": 72,
      "retention_90d": 50,
      "retention_180d": 35
    }
  ],
  "insights": [
    {
      "finding": "2025年6月以降のコホートはNPS・リテンションが改善",
      "hypothesis": "6月リリースの新機能（〇〇）が効果",
      "recommendation": "新機能の効果を詳細分析、さらなる改善"
    },
    {
      "finding": "2025年1月コホートはチャーン率が高い",
      "hypothesis": "初期バグ、オンボーディング不足",
      "recommendation": "既存ユーザーへの再アクティベーション施策"
    }
  ]
}
```

**コホート分析のビジュアル化**:
- リテンション曲線（登録後30日、60日、90日、180日のリテンション率）
- ヒートマップ（コホート × 経過期間のリテンション率）

### 2-3. センチメント分析

フィードバックの感情を自動分類（ポジティブ/ネガティブ/ニュートラル）。

**分析手法**:
- **LLM推論**: Claude/GPT-4による文脈理解
- **キーワード抽出**: 頻出単語のTF-IDF分析
- **スコアリング**: -1.0（最もネガティブ）~ +1.0（最もポジティブ）

**出力例**:
```json
{
  "total_feedback": 1500,
  "sentiment_distribution": {
    "positive": 65,
    "neutral": 20,
    "negative": 15
  },
  "sentiment_by_category": [
    {
      "category": "UI/UX",
      "positive": 80,
      "neutral": 12,
      "negative": 8,
      "top_positive": ["使いやすい", "直感的", "デザインが美しい"],
      "top_negative": ["ボタンが小さい", "色が見づらい"]
    },
    {
      "category": "機能",
      "positive": 60,
      "neutral": 25,
      "negative": 15,
      "top_positive": ["機能が豊富", "便利"],
      "top_negative": ["〇〇機能がない", "△△が使いにくい"]
    },
    {
      "category": "価格",
      "positive": 40,
      "neutral": 20,
      "negative": 40,
      "top_positive": ["コスパ良い"],
      "top_negative": ["高い", "無料プランが貧弱"]
    }
  ],
  "overall_sentiment_score": 0.52
}
```

**センチメントトレンド分析**:
- 週次・月次のセンチメントスコア推移
- 特定機能リリース前後のセンチメント変化

### 2-4. フィードバック優先順位付け

影響度・緊急度に基づき、改善項目をランキング。

**優先順位スコアリング**:
```python
priority_score = (
    impact_score * 0.5 +       # 影響度（何人に影響するか）
    urgency_score * 0.3 +      # 緊急度（どれだけ深刻か）
    sentiment_score * 0.2      # センチメント（どれだけネガティブか）
)

impact_score = affected_users / total_users * 100
urgency_score = churn_risk / max_churn_risk * 100
sentiment_score = abs(min(sentiment, 0)) * 100
```

**出力例**:
```markdown
# フィードバック優先順位

## 高優先度（即座に対応）
1. **動作が遅い**（優先度スコア: 85）
   - 影響人数: 380人（38%）
   - センチメント: -0.72（非常にネガティブ）
   - 推奨対処: パフォーマンス改善（バックエンド最適化、キャッシング）
   - 期待効果: チャーン率-5%、NPS +8ポイント

2. **価格が高い**（優先度スコア: 78）
   - 影響人数: 280人（28%）
   - センチメント: -0.65（ネガティブ）
   - 推奨対処: 価格見直し（無料プラン機能拡充、年間プラン割引）
   - 期待効果: コンバージョン率+15%、NPS +5ポイント

## 中優先度（次のスプリントで対応）
3. **〇〇機能がない**（優先度スコア: 62）
   - 影響人数: 180人（18%）
   - センチメント: -0.45（やや必ガティブ）
   - 推奨対処: 機能追加（ロードマップに反映）
   - 期待効果: リテンション+8%

4. **オンボーディングが不十分**（優先度スコア: 58）
   - 影響人数: 150人（15%）
   - センチメント: -0.40（やや必ガティブ）
   - 推奨対処: チュートリアル改善、ウォークスルー追加
   - 期待効果: アクティベーション率+12%

## 低優先度（バックログに追加）
5. **デザインの微調整**（優先度スコア: 35）
   - 影響人数: 80人（8%）
   - センチメント: -0.25（軽微）
   - 推奨対処: UI/UXデザイン改善（色、フォント等）
   - 期待効果: NPS +2ポイント
```

**優先順位付けの可視化**:
- 影響度（横軸）× 緊急度（縦軸）の2x2マトリクス
- バブルチャート（バブルサイズ = 影響人数）

---

## 3. 入力パラメータ

### 3-1. 必須パラメータ

**feedback_data** (ファイルパスまたはAPI接続):
- フィードバックデータ（CSV、JSON、またはAPI接続）
- 必須カラム: `user_id`, `feedback_text`, `nps_score`, `date`, `category`
- 例: `Flow/202601/2026-01-03/feedback_data.csv`

**analysis_type** (配列):
- 分析タイプ（複数選択可）
- 選択肢: `nps`, `cohort`, `sentiment`, `prioritization`, `all`
- 例: `["nps", "sentiment", "prioritization"]`

### 3-2. オプションパラメータ

**nps_threshold** (整数):
- NPS基準値
- ForSolo: 40、ForStartup: 50、ForRecruit: 60
- デフォルト: 50

**cohort_definition** (オブジェクト):
- コホート定義
- 例: `{"type": "registration_month", "period": "12months"}`
- デフォルト: `{"type": "registration_month", "period": "6months"}`

**sentiment_categories** (配列):
- センチメント分析のカテゴリ
- 例: `["UI/UX", "機能", "価格", "サポート"]`
- デフォルト: 自動抽出（LLM推論）

**priority_weights** (オブジェクト):
- 優先順位スコアリングの重み
- 例: `{"impact": 0.5, "urgency": 0.3, "sentiment": 0.2}`
- デフォルト: 上記例と同じ

---

## 4. 出力形式

### 4-1. NPSレポート（`nps_report.md`）

```markdown
# NPSレポート: 2026年1月

## 全体NPS
- **NPSスコア**: 45（目標50、達成率90%）
- **推奨者**: 55%（550人）
- **中立者**: 30%（300人）
- **批判者**: 15%（150人）
- **総回答数**: 1,000人

## セグメント別NPS
[表: セグメント別NPS、推奨者%、批判者%、回答数]

## 推奨者の主なコメント
[Top 3コメントテーマと人数]

## 批判者の主なコメント
[Top 3コメントテーマと人数]

## 推奨アクション
[優先順位付けされた改善アクション]
```

### 4-2. コホート分析結果（`cohort_analysis.json`）

```json
{
  "cohort_type": "registration_month",
  "analysis_period": "12months",
  "cohorts": [...],
  "insights": [...],
  "visualizations": {
    "retention_curve": "cohort_retention_curve.png",
    "heatmap": "cohort_heatmap.png"
  }
}
```

### 4-3. センチメント分析結果（`sentiment_analysis.json`）

```json
{
  "total_feedback": 1500,
  "sentiment_distribution": {...},
  "sentiment_by_category": [...],
  "overall_sentiment_score": 0.52,
  "sentiment_trend": [
    {"date": "2026-01-01", "score": 0.48},
    {"date": "2026-01-08", "score": 0.52},
    {"date": "2026-01-15", "score": 0.55}
  ]
}
```

### 4-4. 優先順位付けフィードバック（`priority_feedback.md`）

```markdown
# フィードバック優先順位

## 高優先度（即座に対応）
[優先度スコア上位2-3件、影響人数、センチメント、推奨対処、期待効果]

## 中優先度（次のスプリントで対応）
[優先度スコア中位2-3件]

## 低優先度（バックログに追加）
[優先度スコア下位2-3件]

## 優先順位マトリクス
[影響度 × 緊急度の2x2マトリクス画像]
```

---

## 5. 実行フロー

### STEP 1: データ読み込み・検証（5-10分）

1. フィードバックデータの読み込み（CSV/JSON/API）
2. 必須カラムの存在確認（`user_id`, `feedback_text`, `nps_score`, `date`, `category`）
3. データ型の変換（日付、数値）
4. 欠損値処理

**使用ツール**: Read（CSVファイル）、LLM推論（データクレンジング）

### STEP 2: NPS計算（5-10分）

1. 推奨者・中立者・批判者の分類
2. NPSスコア算出
3. セグメント別NPS計算
4. 推奨者・批判者のコメントテーマ抽出

**使用ツール**: LLM推論（コメントテーマ抽出）

### STEP 3: コホート分析（オプション、10-15分）

1. コホート定義に基づくユーザーグループ化
2. 各コホートのNPS・リテンション・チャーン率計算
3. コホート間の差異分析
4. インサイト生成

**使用ツール**: LLM推論（インサイト生成）

### STEP 4: センチメント分析（オプション、10-20分）

1. フィードバックテキストのセンチメントスコアリング
2. カテゴリ別センチメント分類
3. 頻出キーワード抽出（TF-IDF）
4. センチメントトレンド分析

**使用ツール**: LLM推論（センチメント分析）

### STEP 5: 優先順位付け（10-15分）

1. 影響度・緊急度・センチメントスコア計算
2. 優先度スコア算出
3. ランキング生成
4. 推奨対処・期待効果の生成

**使用ツール**: LLM推論（推奨対処生成）

### STEP 6: レポート生成（5-10分）

1. `nps_report.md`作成
2. `cohort_analysis.json`作成
3. `sentiment_analysis.json`作成
4. `priority_feedback.md`作成
5. ビジュアル化（グラフ、マトリクス）

**使用ツール**: Write（ファイル出力）

---

## 6. Research統合

### 6-1. ForSolo Research

**参照先**: `Solopreneur_Research/`

**統合内容**:
- NPS基準値: 40以上（Build in Public重視）
- フィードバック活用: X/Twitterでの公開対話

**活用方法**: ソロプレナー向けNPS基準値の設定

### 6-2. ForStartup Research

**参照先**: `Founder_Research/`

**統合内容**:
- NPS基準値: 50以上（VC基準）
- リテンション基準: 40%以上

**活用方法**: VC調達を見据えた厳格な基準設定

### 6-3. ForRecruit Research

**参照先**: `Recruit_Product_Research/`

**統合内容**:
- NPS基準値: 60以上（既存顧客満足度重視）
- 社内フィードバック活用: Ring制度評価への反映

**活用方法**: 企業内新規事業向けNPS基準値の設定

---

## 7. エラーハンドリング

### Pattern 1: フィードバック数不足

**エラー**: サンプルサイズが統計分析に不十分（< 100件）

**対処**:
1. 最低100件のフィードバック収集を推奨
2. サンプルサイズ不足の警告を表示
3. 継続的な収集を提案

### Pattern 2: NPS回答偏り

**エラー**: 推奨者または批判者に極端な偏り（> 80%）

**対処**:
1. 回答者バイアスの可能性を警告
2. 回答率向上施策を提案
3. 無回答者へのフォローアップを推奨

### Pattern 3: センチメント分析失敗

**エラー**: フィードバックテキストが短すぎる/不明瞭

**対処**:
1. テキスト長確認（最低10文字推奨）
2. 不明瞭なフィードバックは「ニュートラル」に分類
3. フィードバック収集フォーム改善を提案

### Pattern 4: コホート定義不明瞭

**エラー**: コホート定義のパラメータが不足

**対処**:
1. デフォルトコホート定義を適用（登録月別、6ヶ月）
2. ユーザーに確認を促す
3. 代替コホート定義を提案

---

## 8. 成功指標

| 指標 | 目標値 | 測定方法 |
|------|--------|---------|
| NPS計算精度 | 100% | 手動計算との一致率 |
| センチメント分析精度 | > 85% | 人間評価との一致率 |
| 優先順位付け妥当性 | > 80% | プロダクトマネージャー評価 |
| レポート生成時間 | < 30分 | 実行時間の平均値 |
| フィードバック採用率 | > 60% | 推奨アクションの実行率 |

---

## 9. 参照

### エージェント連携
- **Discovery Automation Agent**: `@.claude/agents/discovery-automation-agent.md`（インタビュー統合）
- **Analytics Dashboard Agent**: `@.claude/agents/analytics-dashboard-agent.md`（AARRR連携）

### Research Database
- **ForSolo**: `@Solopreneur_Research/`（NPS基準値40）
- **ForStartup**: `@Founder_Research/`（NPS基準値50）
- **ForRecruit**: `@Recruit_Product_Research/`（NPS基準値60）

---

**作成者**: Claude Code
**レビュー**: aipm_v0開発チーム
**次回更新**: 実装後のフィードバック反映
