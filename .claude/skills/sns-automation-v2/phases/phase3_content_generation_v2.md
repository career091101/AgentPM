# Phase 3: Content Generation v2

SNS自動化スキル v2のコンテンツ生成フェーズ。LinkedIn/X/Threads向けに投稿を生成します。

**Version**: 2.0（v2対応版）

---

## 概要

Phase 1-2で抽出・分析したTop 3記事を基に、以下の投稿を生成します：

| プラットフォーム | 投稿数 | タイプ | トピック | 説明 |
|----------------|--------|--------|---------|------|
| **LinkedIn** | 3案 | 高野式7パターン | Top 1-3 | 各Top記事から1案ずつ、計3案 |
| **X** | 3スレッド | 5-7ツイート深掘り型 | Top 1-3 | 各Top記事から1スレッドずつ |
| **Threads** | 3投稿 | LinkedIn似スタイル | Top 1-3 | LinkedIn投稿を基に文字数制御 |

**重要ポイント**:
- 全投稿が完全に独立（他投稿への参照なし）
- 派生投稿ロジックは廃止
- Top 1-3それぞれで異なるコンテンツを生成

---

## 実行フロー

### STEP 3.1: LinkedIn投稿生成（10-15分）

**入力**:
- Top 3記事の詳細データ（Phase 2出力）
- 高野式7パターンテンプレート

**処理**:
1. Top 1記事 → LinkedIn案1（高野式パターンA）
2. Top 2記事 → LinkedIn案2（高野式パターンB）
3. Top 3記事 → LinkedIn案3（高野式パターンC）

**出力**:
- LinkedIn投稿3案（各700-900字）
- 各案の品質スコア
- 選択したパターン名

**スキル実行**:
```bash
# generate-sns-posts-takano スキルを使用
# Top 1-3それぞれでLinkedIn投稿を生成
```

**参照**:
- [@../generate-sns-posts-takano/SKILL.md](../generate-sns-posts-takano/SKILL.md)

---

### STEP 3.2: X投稿生成（10-15分）

**入力**:
- Top 3記事の詳細データ
- リプライ分析結果
- Web調査結果

**処理**:

#### Top 1記事 → Xスレッド1（5-7ツイート）

**プロンプト**:
```markdown
あなたはX（旧Twitter）のバイラルコンテンツ専門家です。
以下のTop 1記事について、5-7ツイートの深掘り型スレッドを生成してください。

**記事情報**:
- タイトル: {article_title}
- URL: {article_url}
- 要約: {article_summary}
- リプライ分析: {reply_insights}
- Web調査結果: {research_findings}

**要件**:
1. **完全に独立したスタンドアロン投稿**: 他の投稿を参照しない
2. **5-7ツイート構成**: セマンティック分割で論理的展開
3. **高野式バズパターン適用**: 7パターンから最適パターン選択
4. **280文字制約**: 各ツイートは280文字以内
5. **品質チェックリスト7項目必須**:
   - 引き込み（「マジで」「ヤバい」）
   - 断定型（「答えは単純だ」）
   - 口語体（「〜なんだよね」）
   - 具体的数値（3つ以上）
   - 固有名詞（人名/企業名）
   - 拡張フレーズ（「ここからが本当の話だ」）
   - 問いかけ終結（「あなたはどう思いますか？」）

**スレッド構成例**:
1. フック: 衝撃的な事実で注意喚起
2. 問題提起: なぜこれが重要か
3. データ展開: 具体的数値・事例
4. 深掘り1: 専門家意見・技術詳細
5. 深掘り2: 反論への対応
6. 影響分析: 今後の展望
7. 行動喚起: 読者への問いかけ

出力形式: JSON
{
  "tweets": [
    {"order": 1, "content": "ツイート1本文", "char_count": 278},
    {"order": 2, "content": "ツイート2本文", "char_count": 274},
    ...
  ],
  "total_tweets": 6,
  "pattern_used": "選択した高野式パターン名",
  "quality_check": {
    "引き込み": true,
    "断定型": true,
    "口語体": true,
    "具体的数値": true,
    "固有名詞": true,
    "拡張フレーズ": true,
    "問いかけ終結": true
  }
}
```

#### Top 2記事 → Xスレッド2（5-7ツイート）

同様のプロンプトでTop 2記事について生成。パターンはTop 1と異なるものを選択。

#### Top 3記事 → Xスレッド3（5-7ツイート）

同様のプロンプトでTop 3記事について生成。パターンはTop 1, Top 2と異なるものを選択。

**出力**:
- Xスレッド1: Top 1記事の5-7ツイート
- Xスレッド2: Top 2記事の5-7ツイート
- Xスレッド3: Top 3記事の5-7ツイート

---

### STEP 3.3: Threads投稿生成（文字数制御版）（10-15分）

**入力**:
- LinkedIn投稿3案（STEP 3.1の出力）
- Top 3記事の詳細データ

**処理**:

#### Top 1記事 → Threads投稿1

**プロンプト**:
```markdown
あなたはThreadsコンテンツ専門家です。
以下のLinkedIn Top 1投稿をThreads用に変換してください。

**LinkedIn投稿情報**:
- 投稿本文: {linkedin_post_content}
- 文字数: {linkedin_char_count}
- 対応記事: {article_title}

**変換ルール**:

【LinkedIn投稿が500文字以内の場合】
→ **単一Threads投稿として生成**

1. **完全に独立した投稿**: 他の投稿を参照しない
2. **500文字以内**: Threads制約
3. **LinkedIn似表現維持**:
   - ビジネストーン（専門性+親しみやすさ）
   - 絵文字3-5個使用
   - 口語体3-5回使用（「〜なんですよ」等）
4. **構成**:
   - フック（1-2行）: 注意喚起
   - 本文（3-5行）: 核心的メッセージ
   - CTA（1-2行）: 行動喚起・問いかけ

【LinkedIn投稿が500文字超の場合】
→ **2-3投稿のThreadsスレッドに分割**

1. **セマンティック分割**: 段落・論理単位で自然に分割
2. **各投稿500文字以内**: 1投稿あたりの文字数制約
3. **スレッド構成（2投稿の場合）**:
   - 1投稿目: フック+問題提起+核心メッセージ前半
   - 2投稿目: 核心メッセージ後半+CTA+行動喚起
4. **スレッド構成（3投稿の場合）**:
   - 1投稿目: フック+問題提起
   - 2投稿目: 核心メッセージ展開
   - 3投稿目: 結論+CTA+行動喚起
5. **一貫性維持**: 全投稿でトーン・スタイル統一

**品質チェック**（単一・スレッド共通）:
- 具体的数値（2つ以上）
- 固有名詞（1つ以上）
- 読者への問いかけ
- 絵文字適切配置

出力形式: JSON

【単一投稿の場合】
{
  "type": "single",
  "content": "Threads投稿本文（500文字以内）",
  "char_count": 478,
  "emoji_count": 4,
  "quality_check": {
    "具体的数値": true,
    "固有名詞": true,
    "問いかけ": true
  }
}

【スレッド投稿の場合】
{
  "type": "thread",
  "posts": [
    {"order": 1, "content": "1投稿目本文（500文字以内）", "char_count": 487},
    {"order": 2, "content": "2投稿目本文（500文字以内）", "char_count": 495},
    ...
  ],
  "total_posts": 2,
  "quality_check": {
    "具体的数値": true,
    "固有名詞": true,
    "問いかけ": true
  }
}
```

#### Top 2記事 → Threads投稿2

同様のプロンプトでLinkedIn案2を基に生成。

#### Top 3記事 → Threads投稿3

同様のプロンプトでLinkedIn案3を基に生成。

**出力**:
- Threads投稿1: Top 1（単一 or 2-3投稿スレッド）
- Threads投稿2: Top 2（単一 or 2-3投稿スレッド）
- Threads投稿3: Top 3（単一 or 2-3投稿スレッド）

---

## 品質検証

### LinkedIn投稿（高野式7要素チェック）

全投稿で以下を満たすこと：

- [ ] **① 引き込み**: 1行目で衝撃的数字・企業名・断定型
- [ ] **② データ/事例**: 具体的数値5個以上、企業名3社以上
- [ ] **③ 共感**: 読者（CEO/経営者）の課題に言及
- [ ] **④ 洞察**: "つまり"、"ポイントは"で自己解釈を明示
- [ ] **⑤ アドバイス**: 具体的アクション提案（任意）
- [ ] **⑥ 問いかけ**: 最後に必ずCEO向け問いかけ
- [ ] **⑦ 固有名詞**: 企業名・人名を最低3回使用

### X投稿（バズ要素チェック）

全スレッドで以下を満たすこと：

- [ ] 5-7ツイート構成
- [ ] 各ツイート280文字以内
- [ ] 口語体使用（「マジで」「ヤバい」等）
- [ ] 具体的数値3つ以上（スレッド全体）
- [ ] 固有名詞3回以上（スレッド全体）
- [ ] 問いかけ終結

### Threads投稿（スタイルチェック）

全投稿で以下を満たすこと：

- [ ] 文字数制御（単一: 500文字以内、スレッド: 各500文字以内）
- [ ] LinkedIn似スタイル
- [ ] 絵文字3-5個
- [ ] 口語体3-5回
- [ ] 具体的数値2つ以上
- [ ] 固有名詞1つ以上
- [ ] 問いかけ終結

---

## 出力ファイル

### ファイル構造

```
Flow/202601/2026-01-12/
├── linkedin_posts_v2_{date}.md          # LinkedIn投稿3案
├── x_threads_v2_{date}.json             # Xスレッド3件
└── threads_posts_v2_{date}.json         # Threads投稿3件
```

### LinkedIn投稿ファイル形式

```markdown
# LinkedIn投稿3案（高野式7パターン準拠） v2

**生成日時**: 2026-01-12
**入力ソース**: Top 3 tweets (v2版)

---

## 案1: Top 1記事（パターンA: 数字×断定型）

### 投稿本文（700-900字）

[投稿本文]

(ソースはコメント欄に記載)

### 最初のコメント

**【詳報・出典】**
- [出典情報]

**【私見】** [立場表明]

---

## 案2: Top 2記事（パターンB: 衝撃×企業名）

[同様の構成]

---

## 案3: Top 3記事（パターンC: 問題提起×具体例）

[同様の構成]

---

## 品質スコア

| 案 | 高野式7要素 | フック衝撃度 | 予測ER | 推奨度 |
|----|------------|-------------|--------|--------|
| 案1 | 7/7 | 18/20 | 4.2% | ★★★★★ |
| 案2 | 7/7 | 16/20 | 3.8% | ★★★★☆ |
| 案3 | 7/7 | 15/20 | 3.5% | ★★★☆☆ |
```

### Xスレッドファイル形式

```json
{
  "generated_at": "2026-01-12T10:00:00+09:00",
  "threads": [
    {
      "thread_id": 1,
      "topic": "Top 1記事タイトル",
      "article_url": "https://...",
      "pattern_used": "数字×断定型",
      "tweets": [
        {
          "order": 1,
          "content": "ツイート1本文",
          "char_count": 278
        },
        {
          "order": 2,
          "content": "ツイート2本文",
          "char_count": 274
        }
      ],
      "total_tweets": 6,
      "quality_check": {
        "引き込み": true,
        "断定型": true,
        "口語体": true,
        "具体的数値": true,
        "固有名詞": true,
        "拡張フレーズ": true,
        "問いかけ終結": true
      }
    },
    {
      "thread_id": 2,
      "topic": "Top 2記事タイトル",
      "tweets": [...]
    },
    {
      "thread_id": 3,
      "topic": "Top 3記事タイトル",
      "tweets": [...]
    }
  ]
}
```

### Threads投稿ファイル形式

```json
{
  "generated_at": "2026-01-12T10:00:00+09:00",
  "posts": [
    {
      "post_id": 1,
      "topic": "Top 1記事タイトル",
      "article_url": "https://...",
      "linkedin_source": "案1",
      "type": "single",
      "content": "Threads投稿本文（500文字以内）",
      "char_count": 478,
      "emoji_count": 4,
      "quality_check": {
        "具体的数値": true,
        "固有名詞": true,
        "問いかけ": true
      }
    },
    {
      "post_id": 2,
      "topic": "Top 2記事タイトル",
      "type": "thread",
      "posts": [
        {
          "order": 1,
          "content": "1投稿目本文",
          "char_count": 487
        },
        {
          "order": 2,
          "content": "2投稿目本文",
          "char_count": 495
        }
      ],
      "total_posts": 2,
      "quality_check": {
        "具体的数値": true,
        "固有名詞": true,
        "問いかけ": true
      }
    },
    {
      "post_id": 3,
      "topic": "Top 3記事タイトル",
      "type": "single",
      "content": "...",
      "char_count": 492
    }
  ]
}
```

---

## エラーハンドリング

### LinkedIn投稿生成エラー

**ケース1: 文字数不足（700字未満）**
- **対応**: 自動再生成（データポイント追加）
- **最大リトライ**: 3回
- **3回失敗時**: ユーザーに警告、手動調整を促す

**ケース2: 高野式7要素未達成**
- **対応**: 不足要素を追加して再生成
- **最大リトライ**: 2回

### X投稿生成エラー

**ケース1: 280文字超過**
- **対応**: セマンティック分割で2ツイートに分割
- **最大リトライ**: 3回

**ケース2: スレッド数不足（5ツイート未満）**
- **対応**: データポイント追加で5-7ツイートに拡張
- **最大リトライ**: 2回

### Threads投稿生成エラー

**ケース1: 500文字超過（単一投稿）**
- **対応**: 2-3投稿スレッドに自動分割
- **最大リトライ**: 1回（分割ロジックは確定的）

**ケース2: スレッド各投稿が500文字超過**
- **対応**: セマンティック分割で再分割
- **最大リトライ**: 2回

---

## 参照

- **高野式7パターン**: [@../generate-sns-posts-takano/SKILL.md](../generate-sns-posts-takano/SKILL.md)
- **Phase 2出力**: Top 3記事詳細データ
- **共通ルール**: [@../sns_automation_shared_context.md](../sns_automation_shared_context.md)

---

## 更新履歴

| 日時 | バージョン | 変更内容 |
|------|-----------|---------|
| 2026-01-12 | 2.0 | v2対応版作成。派生ロジック廃止、全投稿独立化、Threads文字数制御追加 |

---

**実装日**: 2026-01-12
**バージョン**: 2.0（sns-automation-v2対応）
