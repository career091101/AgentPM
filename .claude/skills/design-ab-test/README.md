# A/Bテスト設計スキル（Design A/B Test）

## 概要

**Design A/B Test** は、LP・UVP改善時に実施するA/Bテストを包括的に設計・実行するスキルです。仮説設定からWinner判定、ロールアウト計画まで、統計的有意性を確保しながら、データドリブンなコンバージョン率最適化をサポートします。

### このスキルでできること

1. **仮説の定量化** - 改善対象・期待効果・成功基準を明確化
2. **サンプルサイズ計算** - Two-Proportion Z-Test で必要トラフィック数を算出
3. **バリエーション設計** - コントロール + 最大3バリアントの実装体系化
4. **テスト期間推定** - 統計的有意性達成に必要な期間を予測
5. **統計的有意性検定** - p値（<0.05）と95%信頼区間を自動計算
6. **Winner自動判定** - 有意差の有無でWinner決定、再テスト判定
7. **ロールアウト計画** - 段階的展開（80% → 100%）とモニタリング計画

### 対象ステージ

- **Phase2-3**（Discovery → Executing）
- 所要時間：30-40分

---

## 使用タイミング

| タイミング | 条件 | 次のステップ |
|-----------|------|-----------|
| **LP改善時** | UVP・CTA・Pricing改善の仮説あり | サンプルサイズ計算開始 |
| **CVR停滞時** | 月次CVRが前月比-5%以上低下 | 仮説設定で原因追究 |
| **PMF検証後** | Sean Ellisテスト40%以上達成 | 継続的なA/Bテストで最適化 |
| **定期改善サイクル** | 月次1-2回のA/Bテスト実施 | 次の改善対象を優先順位付け |

---

## 入力・出力

| 項目 | 内容 |
|------|------|
| **必須入力** | `lean_canvas.md`, `persona.md`, `lp/index.html`, 現在のCVR測定値 |
| **推奨入力** | `psf_diagnosis.md`, Google Analytics数値, 過去のA/Bテスト結果 |
| **出力** | `Flow/{YYYYMM}/{YYYY-MM-DD}/ab_test_design.md` |
| **次のスキル** | `/build-lp`（Winner反映）、 `/create-sns-content`（成果共有） |

---

## スキル実行フロー

```
STEP 1: 仮説設定
  → 改善対象選択（Hero/CTA/Pricing/Features等）
  → ベースラインCVR測定
  → 期待効果を定量化（例：3% → 5%）

STEP 2: サンプルサイズ計算
  → Two-Proportion Z-Test公式で必要サンプル数算出
  → 例：各バリアント1,571サンプル必要

STEP 3: バリエーション設計
  → コントロール（A）定義
  → バリアント（B/C/D）最大3個設計
  → 差別化ポイント明確化

STEP 4: テスト期間推定
  → 週間トラフィック ÷ 必要サンプル数 = 推定週数
  → 8週間以上の場合、シーズン変動リスク警告

STEP 5: 統計的有意性検定（テスト実施）
  → 期間終了後、p値・95%信頼区間を計算
  → Early Stopping判定（中間段階での有意差確認）

STEP 6: Winner決定
  → p < 0.05：CVR最高バリアントをWinner
  → p ≥ 0.05：再テスト要検討

STEP 7: ロールアウト計画
  → Week 1：80% Winner配分、20% コントロール
  → Week 2：100% Winner展開
  → Week 3-4：モニタリング継続

STEP 8: 成果物出力
  → ab_test_design.md を Flow に生成
```

---

## 実装例 1：CTAボタン最適化（緊急性訴求）

**仮説設定**:
- 改善対象：Hero下部 CTA ボタン
- コントロール：「無料で試す」（緑色）
- バリアント B：「今すぐ無料で試す」（オレンジ色・緊急性）
- 期待効果：CVR 3% → 5%（+67%）

**サンプルサイズ計算**:
```
p1 = 0.03（コントロール）
p2 = 0.05（期待CVR）
α = 0.05, 検出力 = 0.80

必要サンプル数 = 1,571 visitors/variant
テスト期間 = 3,142 ÷ 500 visitors/week = 6.3週間（7週間）
```

**結果**:
- バリアント B CVR = 5.03%（コントロール 2.99%）
- P値 = 0.0006（有意差あり✅）
- Winner：バリアント B（+68%改善）

---

## 実装例 2：Pricing表示方法（年額vs月額）

**仮説設定**:
- 改善対象：Pricing Section
- コントロール：月額 ¥9,900 表示
- バリアント：年額（月額 ¥825換算）表示
- 期待効果：CVR 3% → 3.9%（+30%）

**テスト期間**: 約10週間（サンプルサイズ増加）

---

## よくある質問（FAQ）

### Q1: 2バリアント vs 3バリアント、どちらが良い？

**A**: **2バリアント（A/B）推奨**。理由：
- 3バリアント：サンプルサイズ1.5倍増加、テスト期間延長
- 2バリアント：最速でWinner判定
- 複数改善を試す場合は、連続的なA/Bテスト実施（A→B勝者→Cテスト）

### Q2: テスト期間が8週間以上になった場合は？

**A**: 以下を検討してください：

1. **期待効果を大きくする**（CVR 3% → 6%に引き上げ） → サンプルサイズ50%削減
2. **広告配信でトラフィック増加** → 週間500 → 1,000に倍増
3. **期待効果が現実的か再検討** → ペルソナインタビュー再実施

シーズン変動（年末年始、GW）の影響を避けるため、8週間超は避けることを推奨。

### Q3: Early Stoppingはいつ実施すべき？

**A**: テスト期間の60-70%時点で有意差確認時：

- 中間検定で p < 0.05 が確認できれば、早期終了を検討
- ただし「Multiple Testing問題」を避けるため、1回の中間検定に限定
- 早期終了で2週間短縮できれば、次の改善サイクルを加速

### Q4: 有意差なしの場合、何が原因？

**A**: 以下を順に確認：

1. **サンプルサイズ不足**：期待効果が小さすぎた（3% → 3.5%など）
2. **バリアント設計不適切**：差別化が不足（配色変更のみなど）
3. **ターゲット誤り**：ペルソナと実施ユーザーの乖離
4. **テスト実装エラー**：実装ミス（バリアントが反映されていない）

→ 再テスト前にバリアント再設計を推奨

### Q5: 複数の有意なバリアント（B・Cともに有意）の場合は？

**A**: **CVR最高のバリアントを選択**。

例：
- バリアント B：CVR 5.1%、p = 0.002
- バリアント C：CVR 4.5%、p = 0.01

→ Winner = バリアント B（CVR最高）

ただし、二次効果（離脱率・平均滞在時間）を確認し、副作用がないか検証。

---

## 出力サンプル

実行後、以下を含む `ab_test_design.md` が生成されます：

### セクション1：仮説設定
- 改善対象（チェックリスト）
- 現状のベースラインCVR
- H0（帰無仮説）/ H1（対立仮説）
- 期待効果と根拠
- Primary/Secondary Metrics

### セクション2：サンプルサイズ計算
- 計算パラメータ（p1, p2, α, 検出力）
- 必要サンプル数（各バリアント）
- 推定テスト期間
- 警告（8週間超の場合）

### セクション3：バリエーション設計
| バリアント | CTA文言 | ボタン色 | 配置 |
|-----------|---------|---------|------|
| A（コントロール） | 無料で試す | 緑 | 固定なし |
| B | 今すぐ無料で試す | オレンジ | 固定なし |
| C | 初月無料で試す | 緑 | スティッキー |

### セクション4：テスト期間推定
- テストスケジュール（実装→データ収集→分析）
- リスク（シーズン変動）
- Early Stopping判定条件

### セクション5：統計的有意性検定結果
| バリアント | Visitors | Conversions | CVR | Z-score | P値 |
|-----------|---------|-------------|-----|---------|-----|
| A（コントロール） | 1,571 | 47 | 2.99% | - | - |
| B | 1,571 | 79 | 5.03% | 3.42 | 0.0006 |

### セクション6：Winner決定
- Winner：バリアント B
- 決定根拠（p値、信頼区間、CVR改善率）
- 期待インパクト（月間換算）

### セクション7：ロールアウト計画
- Phase 1（Week 1）：トラフィック80% Winner、20% コントロール
- Phase 2（Week 2）：100% Winner展開
- Phase 3（Week 3-4）：モニタリング（CVR、離脱率、エラー率）

### セクション8：レトロスペクティブ
- 学び（何がCVR改善に貢献したか）
- 次のA/Bテスト候補（優先順位付け）
- フレームワーク準拠チェック

---

## テンプレート一覧

本スキル実行時に以下のテンプレートを参照できます：

1. **ab_test_hypothesis.md** - 仮説設定テンプレート
2. **sample_size_calculator.md** - サンプルサイズ計算シート
3. **ab_test_results.md** - 結果分析・Winner判定フォーマット

---

## 参考資料

| 資料 | パス |
|------|------|
| **A/Bテスト概要** | Stock/programs/創業支援・新規事業開発（AIエージェント）/startup_science/01_stages/ux/ab_testing.md |
| **統計検定詳細** | Stock/programs/創業支援・新規事業開発（AIエージェント）/startup_science/01_stages/ux/statistical_significance.md |
| **UXフレームワーク** | Stock/programs/創業支援・新規事業開発（AIエージェント）/startup_science/01_stages/ux/ux_frameworks.md |

---

## 関連スキル

| スキル | 説明 |
|--------|------|
| **validate-pmf** | PMF達成判定（A/Bテスト本格化の前提） |
| **build-lp** | LPビルド（Winner改善の反映先） |
| **create-sns-content** | SNS発信（テスト成果の共有） |
| **measure-aarrr** | AARRR分析（スケール前のファネル測定） |

---

## 注意事項

1. **最小サンプルサイズ**：各バリアント最低100以上の観測推奨
2. **テスト期間の最小化**：8週間超の場合、期待効果再検討
3. **Peeking問題**：テスト終了前の有意性確認は統計的に無効
4. **Early Stoppingの厳密さ**：中間検定は1回限定を推奨
5. **シーズン変動**：年末年始・祝日を避けてテスト実施

---

## メタデータ

| 項目 | 値 |
|-----|-----|
| **スキルID** | design-ab-test |
| **ステージ** | Phase2-3（Discovery → Executing） |
| **所要時間** | 30-40分 |
| **出力ファイル** | Flow/{YYYYMM}/{YYYY-MM-DD}/ab_test_design.md |
| **フレームワーク準拠** | 起業の科学 - UX最適化（100%） |
| **最終更新** | 2025-12-31 |

---

**質問・改善提案**: スキル実行時の問題やベストプラクティスについてはドキュメント内のセクションを参照してください。
