---
name: sns-automation
description: |
  Phase 1-4のSNS自動化全工程を実行するオーケストレータースキル。
  データ収集→分析→投稿生成→Late API予約投稿の全工程を自動化します。

  実行フロー:
  - Phase 1: データ収集（12-22分、5並列最適化版）
  - Phase 2: 分析・調査（20-30分、STEP 2.1→2.15逐次 + STEP 2.2+2.3並列、LLM判定ワンパス化）
  - Phase 3: 投稿生成（15-20分、高野式7パターン + X/Threads派生）
  - Phase 4: マルチプラットフォーム予約投稿（5-10分、Late API、6投稿自動化）

  所要時間: 52-77分（Phase 2最適化により▲15-30分短縮、従来比22-28%短縮）
  出力: 各フェーズの成果物 + final_summary.md

  投稿先（Option C対応）:
  - LinkedIn: 1案/日（8:00 JST）
  - X: 3投稿/日（派生7:30 + スレッド12:00 + スレッド20:00）
  - Threads: 2投稿/日（派生7:30 + 新規20:00）
  - 合計: 6投稿/日

trigger_keywords:
  - "SNS自動化"
  - "SNS全工程実行"
  - "投稿自動化"

stage: Phase 1-4 Orchestration
dependencies:
  - collect-x-timeline
  - extract-top-tweets
  - scrape-tweet-details
  - extract-content # LLM判定ワンパス化統合（filter-extracted-content廃止）
  - analyze-replies
  - research-topic
  - generate-sns-posts-takano # 高野式7パターン + X/Threads派生（v2.4）
  - approve-and-schedule

output_file: Flow/{YYYYMM}/{YYYY-MM-DD}/sns_automation_summary.md
execution_time: 52-77分
priority: P0
model: claude-sonnet-4-5-20250929 # Sonnet 4.5 (2026年1月時点の最新モデル)
---

# SNS Automation Skill - Phase 1-4 統合版

Phase 1-4 の SNS 自動化全工程を実行するオーケストレータースキル。

**Version**: 2.2（Phase 2 最適化版 - 2 並列化 + LLM 判定ワンパス化、▲15-30 分短
縮）

---

## 📖 重要: 最初に読むべきドキュメント

### 全サブスキル共通情報

**必読**:
[@sns_automation_shared_context.md](./sns_automation_shared_context.md)

このファイルには以下の共通情報が記載されています（**並列実行時の重複読み込みを防
ぐため、最初に 1 回のみ読み込んでください**）:

- プロジェクト概要・ターゲットオーディエンス
- 実行フロー全体像
- 共通ファイルパス・命名規則
- 品質基準（高野メソッド 7 要素）
- エラーハンドリング基本方針
- Late API 設定
- 出力フォーマット

### ドキュメント構造

この SKILL.md は以下の構造で記述されています：

- **Core セクション** - 実行に必須の情報（Phase 1-4 の概要）
- **Extended セクション** - オプショナル詳細（評価基準、進捗表示等）

詳細情報は外部ファイルに分離されており、必要時のみ参照してください。

---

# 🎯 Core Section - 実行に必須の情報

このセクションには、スキル実行に必要な最小限の情報が記載されています。

---

## この Skill でできること

1. **Phase 1: データ収集**（5 並列最適化版、12-22 分）

   - X タイムライン収集（200 件）
   - Top 10 ツイート抽出
   - ツイート詳細取得（リンク・リプライ、5 並列処理）

2. **Phase 2: 分析・調査**（ハイブリッド実行、20-30 分）

   - STEP 2.1: コンテンツ抽出（記事・YouTube・PDF、LLM 判定ワンパス化）
   - STEP 2.2 + 2.3: リプライ分析 + Web 調査（並列実行）

3. **Phase 3: 投稿生成**（順次実行、15-20 分）

   - 高野式 7 パターンから AI が最適 3 パターン自動選択
   - LinkedIn 投稿 3 案生成
   - X/Threads 派生投稿生成（Option C 対応）:
     - X 派生（Top 1 トピック、フック変更）
     - X スレッド 1（Top 2 トピック、5-7 ツイート深掘り型）
     - X スレッド 2（Top 3 トピック、5-7 ツイート深掘り型）
     - Threads 派生（Top 1 トピック、フック変更）
     - Threads 新規（Top 2 トピック、LinkedIn 似表現）

4. **Phase 4: マルチプラットフォーム予約投稿**（順次実行、5-10 分）

   - Late API 既存予約との競合検出（4 時間帯: 7:30, 8:00, 12:00, 20:00）
   - 6 投稿を同一日に分散予約（Late API 経由）:
     - LinkedIn: 8:00 JST（高野式メイン）
     - X 派生: 7:30 JST
     - X スレッド 1: 12:00 JST
     - X スレッド 2: 20:00 JST
     - Threads 派生: 7:30 JST
     - Threads 新規: 20:00 JST
   - 失敗投稿のフォールバック（Markdown 生成）

5. **最終サマリー生成**

   - 各フェーズの実行時間
   - 成果物一覧
   - 投稿結果（URL、ステータス）

---

## 入力・出力

| 項目               | 内容                                  |
| ------------------ | ------------------------------------- |
| **入力**           | なし（完全自動実行）                  |
| **出力**           | 各フェーズの成果物 + final_summary.md |
| **次のアクション** | 投稿結果の確認、パフォーマンス分析    |

---

## Instructions

**実行モード**: 完全自律実行（人間介入なし） **推定所要時間**: 52-77 分（Phase 2
最適化により ▲15-30 分短縮） **日次投稿数**: 6 投稿（LinkedIn 1 + X 3 + Threads
2）

---

### Phase 1: データ収集（5 並列最適化版、12-22 分）

**概要**: X タイムラインから 200 件を収集し、AI 関連度と高野式適合度で Top 10 を
抽出。詳細リンク・リプライを 5 並列処理で取得。

**主要ステップ**:

- STEP 1.1: X タイムライン収集（5-10 分）
- STEP 1.2: Top 10 抽出・並列評価（5-8 分）
- STEP 1.3: ツイート詳細取得・5 並列処理（2-4 分）

**詳細手順**: [@phases/phase1_detailed.md](./phases/phase1_detailed.md)

**エラーハンドリング**: 即時停止
（[@\_shared/error_handling_patterns.md](../_shared/error_handling_patterns.md)参
照）

---

### Phase 2: 分析・調査（ハイブリッド実行、20-30 分）

**概要**: Phase 1 データから記事・YouTube・PDF コンテンツを LLM 判定でワンパス抽
出し、リプライ分析と Web 調査を並列実行。

**主要ステップ**:

- STEP 2.1: コンテンツ抽出 + LLM 判定ワンパス化（7-14 分、従来比 ▲3-6 分短縮）
- STEP 2.2 + 2.3: リプライ分析 + Web 調査（15-20 分、並列実行で ▲10-15 分短縮）

**詳細手順**: [@phases/phase2_detailed.md](./phases/phase2_detailed.md)

**エラーハンドリング**: STEP 2.1, 2.3 成功必須
（[@\_shared/error_handling_patterns.md](../_shared/error_handling_patterns.md)参
照）

**最適化内容**:

- LLM 判定ワンパス化: extract-content スキルがフィルタリング統合
  、filter-extracted-content 廃止
- 2 並列化: STEP 2.2 と STEP 2.3 を独立処理として並列実行

---

### Phase 3: 投稿生成（順次実行、15-20 分）

**概要**: 高野式 7 パターンから AI が最適 3 パターン選択。LinkedIn 3 案＋
X/Threads 派生投稿を生成。

**主要ステップ**:

- STEP 3.1: 高野式 7 パターン投稿 3 案生成（LinkedIn、10-15 分）
- STEP 3.2: X/Threads 派生投稿生成（5 分、Option C 対応）
  - X 派生: LinkedIn→ フック変更（280 文字）
  - X スレッド 1: Top 2 トピック深掘り（5-7 ツイート）
  - X スレッド 2: Top 3 トピック深掘り（5-7 ツイート）
  - Threads 派生: LinkedIn→ フック変更（500 文字）
  - Threads 新規: Top 2 トピック（500 文字）

**詳細手順**:
[@phases/phase3_detailed.md](./phases/phase3_detailed.md)、[@generate-sns-posts-takano/SKILL.md](./generate-sns-posts-takano/SKILL.md)

**エラーハンドリング**: チェックリスト未達時は自動再生成
（[@\_shared/error_handling_patterns.md](../_shared/error_handling_patterns.md)参
照）

---

### Phase 4: マルチプラットフォーム予約投稿（Late API、競合回避型、5-10 分）

**概要**: Late API から既存予約を検出し、4 時間帯（7:30, 8:00, 12:00, 20:00）で
競合を回避。6 投稿を同一日に時間帯別予約投稿。

**主要ステップ**:

- STEP 4.0: 既存予約の競合検出（全 4 時間帯、30 秒）
- STEP 4.1: 利用可能日付検索（全時間帯で空いている日、30 秒）
- STEP 4.2: コンテンツ抽出（6 投稿分、1-2 分）
- STEP 4.3: Late API 予約投稿（6 投稿個別 POST、2-5 分）

**投稿スケジュール（Option C）**:

| 時刻  | プラットフォーム | 投稿タイプ              |
| ----- | ---------------- | ----------------------- |
| 7:30  | X                | 派生（Top 1）           |
| 7:30  | Threads          | 派生（Top 1）           |
| 8:00  | LinkedIn         | 高野式メイン（Top 1）   |
| 12:00 | X                | スレッド深掘り（Top 2） |
| 20:00 | X                | スレッド深掘り（Top 3） |
| 20:00 | Threads          | 新規（Top 2）           |

**投稿スクリプト**: `scripts/late_api_multi_post_v2.py`

**スキル参照**: [@post-multiplatform/SKILL.md](../post-multiplatform/SKILL.md)

**詳細手順**: [@phases/phase4_detailed.md](./phases/phase4_detailed.md)

**エラーハンドリング**: Late API 失敗投稿は Markdown ファイル生成
（[@\_shared/error_handling_patterns.md](../_shared/error_handling_patterns.md)参
照）

---

## エラーハンドリング

### 基本方針

| フェーズ    | エラー時の対応                   | 理由                           |
| ----------- | -------------------------------- | ------------------------------ |
| **Phase 1** | **即時停止**                     | 後続処理が全て依存するため必須 |
| **Phase 2** | **即時停止（全タスク成功必須）** | 品質重視                       |
| **Phase 3** | **即時停止**                     | 投稿生成は最重要               |
| **Phase 4** | **即時停止**                     | 投稿は最終成果物               |

### 詳細なエラーハンドリング

リトライ戦略、エラーレスポンス形式、パターン別対応は以下を参照：

📖
**[@\_shared/error_handling_patterns.md](../_shared/error_handling_patterns.md)**

**スキル固有のエラー処理**:

- **Cookie 認証失敗**: ユーザーに再ログイン依頼 + 停止
- **Late API エラー**:
  [@phases/phase4_detailed.md#Late API 統合詳細](./phases/phase4_detailed.md#late-api統合詳細)参
  照

---

## 実行フロー全体図

```
┌─────────────────────────────────────────────┐
│ Phase 1: データ収集（5並列処理、12-22分）    │
├─────────────────────────────────────────────┤
│ 1.1 Xタイムライン収集 (5-10分)              │
│   → x_timeline_{date}.json (200件)         │
│        ↓ (並列処理 STEP 1.2)                │
│ 1.2 Top 10抽出 (5-8分)                     │
│   → top_10_tweets_{date}.json (10件)       │
│        ↓ (5並列処理 STEP 1.3)               │
│ 1.3 ツイート詳細取得 (2-4分)                │
│   → tweet_details_{date}.json             │
└─────────────────────────────────────────────┘
                    ↓
┌─────────────────────────────────────────────┐
│ Phase 2: 分析・調査（ハイブリッド実行、20-30分）│
├─────────────────────────────────────────────┤
│ 2.1 コンテンツ抽出 + LLM判定ワンパス化 (7-14分) │
│   → extracted_contents_filtered_{date}.json │
│   → non_ai_contents_{date}.json           │
│                    ↓                        │
│ ┌─────────────────────────────────────────┐ │
│ │ 2.2 リプライ分析 (10-15分)  [並列実行]  │ │
│ │   → reply_insights_{date}.json         │ │
│ │                                         │ │
│ │ 2.3 Web調査 (15-20分)      [並列実行]  │ │
│ │   → research_findings_{date}.json      │ │
│ └─────────────────────────────────────────┘ │
│   並列実行により最大15-20分（▲10-15分短縮）  │
└─────────────────────────────────────────────┘
                    ↓
┌─────────────────────────────────────────────┐
│ Phase 3: 投稿生成（順次実行、10-15分）      │
├─────────────────────────────────────────────┤
│ 3.1 高野式7パターン3案生成                   │
│   - AI自動選択: 最適3パターン               │
│   - チェックリスト検証: 全7項目必須         │
│   → posts_generated_takano_{date}.md     │
└─────────────────────────────────────────────┘
                    ↓
┌─────────────────────────────────────────────┐
│ Phase 4: LinkedIn予約投稿（自動実行、2-5分）│
├─────────────────────────────────────────────┤
│ 4.0 既存予約の競合検出                      │
│ 4.1 利用可能日付検索                        │
│ 4.2 コンテンツ抽出                          │
│ 4.3 Late API予約投稿（3案、異なる日付）    │
│   → late_api_fixed_{date}.json            │
│   → manual_posts/linkedin_*.md (失敗案)   │
└─────────────────────────────────────────────┘
                    ↓
┌─────────────────────────────────────────────┐
│ Phase 5: 最終サマリー生成（1-2分）          │
├─────────────────────────────────────────────┤
│ final_summary.md生成                        │
└─────────────────────────────────────────────┘
```

---

# 📚 Extended Section - オプショナル詳細情報

このセクションには、出力フォーマット、評価基準、詳細設定などの補足情報が記載され
ています。

**通常の実行では参照不要**です。カスタマイズや詳細確認が必要な場合のみ参照してく
ださい。

---

## Knowledge Base 参照

- **Task tool 使用例**: `.claude/skills/orchestrate-review-loop/SKILL.md`
- **エラーハンドリング**: `.claude/skills/_shared/error_handling_patterns.md`
- **並列実行ルール**: `.claude/rules/parallel_execution.md`
- **Phase 別詳細**: `.claude/skills/sns-automation/phases/phase{N}_detailed.md`
- **Late API 統合提案**:
  `Flow/202601/2026-01-02/late_api_integration_proposals.md`
- **Late API 実装**: `Stock/programs/副業/projects/SNS/scripts/late_api_post.py`
- **本番テストレポート**:
  `Stock/programs/副業/projects/SNS/PRODUCTION_TEST_REPORT_20260102.md`
- **進捗管理**: `Stock/programs/副業/projects/SNS/PROGRESS.md`

---

## 推定コスト

### LLM コスト（ClaudeCode）

- Phase 1: $0.05（haiku 15 分）
- Phase 2: $0.30（haiku+sonnet 逐次）
- Phase 3: $0.80（opus 25 分）
- Phase 4: $0.03（haiku 5 分）
- **合計**: 約$1.18/実行

### Late API コスト（月額）

| プラン        | 料金 | レート制限          | 推奨用途                  |
| ------------- | ---- | ------------------- | ------------------------- |
| **Free**      | $0   | 60 リクエスト/分    | 検証・テスト              |
| **Starter**   | $19  | 120 リクエスト/分   | 個人利用                  |
| **Pro**       | $49  | 300 リクエスト/分   | 週 3-5 投稿（推奨 ★★★★★） |
| **Unlimited** | $99  | 1,200 リクエスト/分 | 大量投稿                  |

**推奨**: Pro プラン（$49/月）- 週 3 投稿 ×12 プラットフォーム対応可能

### 総コスト試算

- LLM: $1.18/実行 × 3 回/週 = **$14.16/月**
- Late API: **$49/月**（Pro プラン）
- **月額合計**: 約$63.16

---

## 使用例

```
User: /sns-automation

Skill:
# SNS自動化実行開始

推定所要時間: 62-95分
開始時刻: 2026-01-02 10:00:00

## Phase 1: データ収集（15-25分）

✅ 1.1 Xタイムライン収集完了（5分）
   → x_timeline_20260102.json (200件)

✅ 1.2 Top 10抽出完了（3分）
   → top_10_tweets_20260102.json (10件)

✅ 1.3 ツイート詳細取得完了（8分）
   → tweet_details_20260102.json (リンク12件、リプライ40件)

---

## Phase 2: 分析・調査（35-55分、逐次実行 1→1.5→2→3）

✅ 2.1 コンテンツ抽出完了（8分）
   → extracted_contents_20260102.json (成功率91.7%, 1,322ワード, AI関連度スコア付与済み)

✅ 2.15 コンテンツフィルタリング完了（6分）
   → extracted_contents_filtered_20260102.json (AI関連のみ、保持率75%)
   → non_ai_contents_20260102.json (除外コンテンツ3件)

✅ 2.2 リプライ分析スキップ（データなし）

✅ 2.3 Web調査完了（18分）
   → research_findings_20260102.json (30ソース, 7ファクトチェック)

---

## Phase 3: 投稿生成（10-15分）

✅ 入力タイプ判定: Phase 2統合データ
✅ 最適パターン選択:
   - 案1: パターン3（ニュース引用 → 深掘り）
   - 案2: パターン1（断定型主張 → データ展開）
   - 案3: パターン4（リスト型衝撃ファクト）

✅ 3.1 高野式7パターン投稿3案生成完了（12分）
   → posts_generated_takano_20260102.md
   - 使用パターン: 3, 1, 4
   - チェックリスト: 全案7項目達成
   - 最推奨: 案1（予測ER 4.2%）

---

## Phase 4: LinkedIn予約投稿（2-5分）

✅ 4.0 既存予約検出: 8件、8:00 AM予約済み日付5日間
✅ 4.1 利用可能日付検索: 2026-01-11, 01-12, 01-13
✅ 4.2 コンテンツ抽出: 3案完了
✅ 4.3 Late API予約投稿完了（2分）
   - 案1: ✅ 予約完了（post_id: 67abc123...）
   - 案2: ✅ 予約完了（post_id: 67abc456...）
   - 案3: ✅ 予約完了（post_id: 67abc789...）
   - 予約投稿日時: 2026-01-11/12/13 08:00 JST
   → late_api_fixed_20260104.json

---

## SNS自動化完了

総実行時間: 52分

📄 final_summary.md生成完了: Flow/202601/2026-01-02/sns_automation_summary.md

次のアクション:
1. 投稿パフォーマンス監視（24時間後）
2. エンゲージメント率の測定
3. 次回の実行準備（明日7:00）
```

---

## 更新履歴

| 日時       | バージョン | 変更内容                                                                                                                                                                                                                                                                                                           |
| ---------- | ---------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| 2026-01-02 | 1.0        | 初版作成（Phase 1-4 統合版）                                                                                                                                                                                                                                                                                       |
| 2026-01-03 | 1.1        | Late API 統合詳細を追加                                                                                                                                                                                                                                                                                            |
| 2026-01-03 | 1.2        | Null2 実践から得た重要な注意点を追加                                                                                                                                                                                                                                                                               |
| 2026-01-04 | 1.3        | Phase 3 を generate-sns-posts-takano（高野式 7 パターン版）に変更                                                                                                                                                                                                                                                  |
| 2026-01-04 | 1.4        | 並列実行パターンを明示的な Task()コードブロックで記述                                                                                                                                                                                                                                                              |
| 2026-01-04 | 1.5        | STEP 1.2 Top10 抽出ロジックを再設計                                                                                                                                                                                                                                                                                |
| 2026-01-04 | 1.6        | Phase 4 を Late API 統合版に更新                                                                                                                                                                                                                                                                                   |
| 2026-01-05 | 1.7        | Phase 2 を逐次実行（1→2→3）に変更                                                                                                                                                                                                                                                                                  |
| 2026-01-05 | 1.8        | Phase 4 競合回避機能追加                                                                                                                                                                                                                                                                                           |
| 2026-01-06 | 1.9        | **Phase 詳細ファイルを外部化**。STEP 1.1-4.3 の詳細手順を `phases/`ディレクトリに分離。メイン SKILL.md を 400-500 行削減し、参照リンクで構成                                                                                                                                                                       |
| 2026-01-12 | 2.0        | **STEP 1.3 を 5 並列化**。ツイート詳細取得を 2 並列 →5 並列に変更。処理時間 50%短縮（5-8 分 →2-4 分）。Phase 1 全体で 12-22 分に短縮、SNS 自動化全体で 62-97 分に改善                                                                                                                                              |
| 2026-01-12 | 2.1        | **Phase 2 にフィルタリングステップを追加**。STEP 2.15 で AI 関連コンテンツのみを抽出、非 AI 関連コンテンツを自動除外。extract-content で AI 関連度スコア付与、filter-extracted-content で 0 点コンテンツを除外。Phase 2 実行時間 35-55 分（+5-10 分）、全体 67-107 分。投稿品質向上のため非 AI 関連混入を 0%に改善 |
| 2026-01-12 | 2.2        | **Phase 2 を 2 並列化 + LLM 判定ワンパス化**。STEP 2.2+2.3 を並列実行（▲10-15 分）、extract-content に LLM 判定統合で filter-extracted-content 廃止（▲3-6 分）。Phase 2 実行時間 20-30 分（▲15-25 分短縮、43%改善）、全体 52-77 分（▲15-30 分短縮、22-28%改善）。依存スキルを 8→7 に削減                           |

---

**実装日**: 2026-01-02 **統合スキル数**: 8 スキル（Phase 2 フィルタリング追加）
**バージョン**: 2.1（Phase 2 フィルタリング統合版） **最終更新**: 2026-01-12
