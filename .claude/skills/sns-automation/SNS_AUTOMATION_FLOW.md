# SNS自動化スキル 実行フロー

**Version**: 2.0（Option C対応版）
**最終更新**: 2026-01-07

---

## 全体フロー図

```
┌─────────────────────────────────────────────────────────────┐
│                    /sns-automation                          │
│                  （オーケストレーター）                       │
│                   所要時間: 70-105分                         │
└─────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────┐
│ Phase 1: データ収集（15-25分）                               │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│  ┌──────────────────────┐                                   │
│  │ collect-x-timeline   │ Xタイムライン200件収集             │
│  │ (5-10分)             │ → x_timeline_{date}.json          │
│  └──────────┬───────────┘                                   │
│             ▼                                               │
│  ┌──────────────────────┐                                   │
│  │ extract-top-tweets   │ AI関連Top 10抽出                  │
│  │ (3-5分, 並列2タスク)  │ → top_10_tweets_{date}.json      │
│  └──────────┬───────────┘                                   │
│             ▼                                               │
│  ┌──────────────────────┐                                   │
│  │ scrape-tweet-details │ リンク・リプライ取得               │
│  │ (5-8分, 並列2バッチ)  │ → tweet_details_{date}.json      │
│  └──────────────────────┘                                   │
└─────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────┐
│ Phase 2: 分析・調査（30-45分、逐次実行）                     │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│  ┌──────────────────────┐                                   │
│  │ extract-content      │ 記事・YouTube・PDFコンテンツ抽出   │
│  │ (5-10分)             │ → extracted_contents_{date}.json  │
│  └──────────┬───────────┘                                   │
│             ▼                                               │
│  ┌──────────────────────┐                                   │
│  │ analyze-replies      │ リプライ分析（※データなし時スキップ）│
│  │ (10-15分)            │ → reply_insights_{date}.json      │
│  └──────────┬───────────┘                                   │
│             ▼                                               │
│  ┌──────────────────────┐                                   │
│  │ research-topic       │ Web調査（ファクトチェック・専門家） │
│  │ (15-20分)            │ → research_findings_{date}.json   │
│  └──────────────────────┘                                   │
└─────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────┐
│ Phase 3: 投稿生成（15-20分）                                 │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│  ┌──────────────────────────────────────────────┐           │
│  │ generate-sns-posts-takano                    │           │
│  │ (15-20分, model: opus)                       │           │
│  ├──────────────────────────────────────────────┤           │
│  │ 入力: Phase 2の全データ統合                   │           │
│  │                                              │           │
│  │ 処理:                                        │           │
│  │ 1. 高野式7パターンから最適3パターン自動選択   │           │
│  │ 2. LinkedIn投稿3案生成                       │           │
│  │ 3. X派生投稿生成（Top 1フック変更）          │           │
│  │ 4. Xスレッド1生成（Top 2、5-7ツイート）      │           │
│  │ 5. Xスレッド2生成（Top 3、5-7ツイート）      │           │
│  │ 6. Threads派生投稿生成（Top 1フック変更）    │           │
│  │ 7. Threads新規投稿生成（Top 2）              │           │
│  │ 8. チェックリスト検証（全7項目必須）          │           │
│  │                                              │           │
│  │ 出力: posts_generated_takano_{date}.md       │           │
│  └──────────────────────────────────────────────┘           │
└─────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────┐
│ Phase 4: マルチプラットフォーム予約投稿（5-10分）            │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│  ┌──────────────────────────────────────────────┐           │
│  │ post-multiplatform                           │           │
│  │ (5-10分, Late API)                           │           │
│  ├──────────────────────────────────────────────┤           │
│  │ 処理:                                        │           │
│  │ 1. 環境変数チェック                          │           │
│  │ 2. 既存予約取得・競合検出（4時間帯）          │           │
│  │ 3. 利用可能日付決定                          │           │
│  │ 4. 6投稿コンテンツ抽出                       │           │
│  │ 5. ユーザー確認                              │           │
│  │ 6. Late API 6回POST                         │           │
│  │                                              │           │
│  │ 出力: late_api_multiplatform_{timestamp}.json│           │
│  └──────────────────────────────────────────────┘           │
│                                                             │
│  投稿スケジュール（Option C）:                               │
│  ┌─────────┬────────────┬─────────────────────┐             │
│  │ 時刻    │ Platform   │ タイプ              │             │
│  ├─────────┼────────────┼─────────────────────┤             │
│  │ 7:30    │ X          │ 派生（Top 1）       │             │
│  │ 7:30    │ Threads    │ 派生（Top 1）       │             │
│  │ 8:00    │ LinkedIn   │ 高野式メイン        │             │
│  │ 12:00   │ X          │ スレッド（Top 2）   │             │
│  │ 20:00   │ X          │ スレッド（Top 3）   │             │
│  │ 20:00   │ Threads    │ 新規（Top 2）       │             │
│  └─────────┴────────────┴─────────────────────┘             │
└─────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────┐
│ Phase 5: 最終サマリー生成（1-2分）                           │
├─────────────────────────────────────────────────────────────┤
│  → Flow/{YYYYMM}/{YYYY-MM-DD}/sns_automation_summary.md     │
└─────────────────────────────────────────────────────────────┘
```

---

## 出力ファイル一覧

| Phase | ファイル | 内容 |
|-------|---------|------|
| 1 | `x_timeline_{date}.json` | 200件のツイート |
| 1 | `top_10_tweets_{date}.json` | AI関連Top 10 |
| 1 | `tweet_details_{date}.json` | リンク・リプライ |
| 2 | `extracted_contents_{date}.json` | 記事コンテンツ |
| 2 | `reply_insights_{date}.json` | リプライ分析 |
| 2 | `research_findings_{date}.json` | Web調査結果 |
| 3 | `posts_generated_takano_{date}.md` | 投稿3案 + X/Threads派生 |
| 4 | `late_api_multiplatform_{timestamp}.json` | 予約投稿結果 |
| 5 | `sns_automation_summary.md` | 最終サマリー |

---

## Phase別詳細

### Phase 1: データ収集（15-25分）

| ステップ | スキル | 処理内容 | 出力 |
|---------|--------|---------|------|
| 1.1 | collect-x-timeline | Xホームタイムライン200件収集 | x_timeline_{date}.json |
| 1.2 | extract-top-tweets | AI関連度+高野式適合度でTop 10抽出 | top_10_tweets_{date}.json |
| 1.3 | scrape-tweet-details | リンク・リプライ詳細取得 | tweet_details_{date}.json |

### Phase 2: 分析・調査（30-45分）

| ステップ | スキル | 処理内容 | 出力 |
|---------|--------|---------|------|
| 2.1 | extract-content | 記事・YouTube・PDFコンテンツ抽出 | extracted_contents_{date}.json |
| 2.2 | analyze-replies | リプライ4カテゴリ分類・インサイト抽出 | reply_insights_{date}.json |
| 2.3 | research-topic | ファクトチェック・専門家意見収集 | research_findings_{date}.json |

### Phase 3: 投稿生成（15-20分）

| スキル | 処理内容 | 出力 |
|--------|---------|------|
| generate-sns-posts-takano | 高野式7パターンで3案生成 + X/Threads派生 | posts_generated_takano_{date}.md |

**生成される投稿**:
- LinkedIn投稿3案（高野式7パターン、1,150-1,300文字）
- X派生投稿（Top 1、フック変更、280文字）
- Xスレッド1（Top 2、5-7ツイート）
- Xスレッド2（Top 3、5-7ツイート）
- Threads派生投稿（Top 1、フック変更、500文字）
- Threads新規投稿（Top 2、500文字）

### Phase 4: 予約投稿（5-10分）

| スキル | 処理内容 | 出力 |
|--------|---------|------|
| post-multiplatform | Late API経由で6投稿予約 | late_api_multiplatform_{timestamp}.json |

**投稿スケジュール（Option C）**:

| 時刻 | プラットフォーム | タイプ | トピック |
|------|----------------|--------|---------|
| 7:30 | X | 派生（フック変更） | Top 1 |
| 7:30 | Threads | 派生（フック変更） | Top 1 |
| 8:00 | LinkedIn | 高野式メイン | Top 1 |
| 12:00 | X | スレッド深掘り | Top 2 |
| 20:00 | X | スレッド深掘り | Top 3 |
| 20:00 | Threads | 新規 | Top 2 |

---

## 個別スキル実行

オーケストレーター(`/sns-automation`)を使わず、個別に実行することも可能：

```bash
# Phase 1のみ
/collect-x-timeline

# Phase 3のみ（Phase 2の出力が必要）
/generate-sns-posts-takano

# Phase 4のみ（Phase 3の出力が必要）
/post-multiplatform
```

---

## 必要な環境変数

```bash
# .env ファイル
LATE_API_KEY=sk_...
LATE_LINKEDIN_ACCOUNT_ID=...
LATE_TWITTER_ACCOUNT_ID=...
LATE_THREADS_ACCOUNT_ID=...
```

---

## 関連ドキュメント

- [SKILL.md](./SKILL.md) - オーケストレーター詳細
- [sns_automation_shared_context.md](./sns_automation_shared_context.md) - 共有コンテキスト
- [generate-sns-posts-takano/SKILL.md](./generate-sns-posts-takano/SKILL.md) - 投稿生成スキル
- [post-multiplatform/SKILL.md](../post-multiplatform/SKILL.md) - マルチプラットフォーム投稿スキル
