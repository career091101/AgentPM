# TOP10ツイート抽出におけるAI関連フィルタリング問題の調査報告

**調査日時**: 2026-01-12
**対象ファイル**: `Flow/202601/2026-01-12/top_10_tweets_20260112.json`

---

## 🔍 問題の概要

TOP10ツイートとして抽出された10件のうち、**AI関連以外のツイートが大量に含まれている**。

### 抽出されたツイートの内訳

| Rank | ユーザー | 内容 | AI関連度 | 判定 |
|------|---------|------|---------|------|
| 1 | MAGAVoice | Elon Muskの政治資金援助 | ❌ 0点 | 政治ニュース |
| 2 | iam_smx | Elon Muskの成功要因（自己啓発） | ❌ 0点 | ビジネス一般 |
| 3 | cb_doge | OptimusロボットとJensen Huang発言 | ⚠️ 1-2点 | ロボット（AI周辺） |
| 4 | prscustom24apna | 古河電工の株主情報 | ❌ 0点 | 株式投資 |
| 5 | Oc4Um | YouTubeチャンネル収益化 | ❌ 0点 | マーケティング |
| 6 | argos_M1111 | Mac US配列キーボード | ❌ 0点 | ガジェット |
| 7 | cozeblog | 目標達成システム設計 | ❌ 0点 | 自己啓発 |
| 8 | yukimamax | ウォーレン・バフェット投資論 | ❌ 0点 | 投資一般 |
| 9 | pirania0630 | 日経平均株価見通し | ❌ 0点 | 株式市場 |
| 10 | JapanTank | RAGの組織的課題 | ✅ 3点 | **AI関連（RAG技術）** |

**結果**: 10件中**1件のみ**がAI関連（AI関連率: **10%**）

---

## 🛠️ 原因分析

### 1. **AI関連フィルタリングが実装されていない**

#### 現在の実装状況

**ファイル**: `Stock/programs/副業/projects/SNS/scripts/extract_top_tweets.py`

```python
# AI関連判定はClaudeCode LLMで実行
# このスクリプトはツイートデータを準備するのみ
```

**実装内容**:
- ✅ エンゲージメントスコア計算
- ✅ 著名人除外フィルタリング（Elon Musk等8名）
- ✅ 日本語/外国人比率調整（7:3）
- ❌ **AI関連度フィルタリング（未実装）**

**問題点**:
- コメントに「ClaudeCode LLMで実行」と記載されているが、実際にはLLM判定が呼び出されていない
- エンゲージメントスコアが高ければ、内容に関わらずTOP10に選出される

### 2. **AI関連度判定基準は存在する**

**ファイル**: `.claude/skills/_shared/ai_relevance_criteria.md`（293行）

以下の判定基準が既に定義されている:

#### スコアリング基準（0-3点）

| スコア | 判定基準 | 具体例 |
|--------|---------|--------|
| **3点** | 明示的なAI技術キーワード | LLM, ChatGPT, Claude, GPT, Gemini, transformer, RAG |
| **2点** | AI企業名 + ニュース/技術詳細 | OpenAI, Anthropic, DeepMind + 発表/研究 |
| **1点** | ML/データサイエンス主題 | machine learning, データサイエンス, 予測モデル |
| **0点** | 上記以外 | 一般ビジネス、マーケティング、政治、株式投資 |

#### 合格基準

| 用途 | 最低スコア | 理由 |
|------|----------|------|
| **Top 10抽出** | **1点以上** | 初期フィルタリング段階 |
| **LinkedIn投稿** | **2点以上** | 高品質なAI関連コンテンツ |

### 3. **フィルタリング実装が分散している**

#### 関連ファイルの状態

| ファイル | 状態 | 役割 |
|---------|------|------|
| `extract_top_tweets.py` | ✅ 実装済み | TOP10抽出（AI判定なし） |
| `filter-extracted-content/filter_ai_relevance.py` | ❌ 存在しない | AI関連度フィルタリング |
| `.claude/skills/_shared/ai_relevance_criteria.md` | ✅ 定義済み | AI関連度判定基準 |
| `.claude/skills/filter-extracted-content/SKILL.md` | ⚠️ 未確認 | フィルタリングスキル定義 |

**問題点**:
- AI関連度判定の**基準は存在**するが、**実装スクリプトが存在しない**
- `extract_top_tweets.py` はエンゲージメント抽出のみで、AI判定はスキップされている

---

## 📋 期待される動作（本来の仕様）

### Phase 1.2: ツイート抽出フロー

```
[タイムライン収集]
    ↓
[著名人除外フィルタ] ← ✅ 実装済み
    ↓
[AI関連度判定] ← ❌ 未実装（ここが欠落）
    ↓ 1点以上のみ通過
[エンゲージメントソート] ← ✅ 実装済み
    ↓
[日本語7:外国人3抽出] ← ✅ 実装済み
    ↓
[TOP10出力]
```

### 現在の実際の動作

```
[タイムライン収集]
    ↓
[著名人除外フィルタ] ← ✅ 実装済み
    ↓
[エンゲージメントソート] ← ✅ 実装済み
    ↓
[日本語7:外国人3抽出] ← ✅ 実装済み
    ↓
[TOP10出力] ← ⚠️ AI関連以外も含まれる
```

---

## 🔧 解決策

### Option A: extract_top_tweets.py に AI判定を追加（推奨）

**メリット**:
- 単一スクリプトで完結
- エンゲージメント計算と同時にAI判定可能
- 実行速度が速い

**実装方針**:
1. `ai_relevance_criteria.md` のキーワードリストを読み込み
2. ツイートテキストとキーワードをマッチング
3. スコア1点以上のツイートのみフィルタリング
4. エンゲージメントソート → TOP10抽出

**実装箇所**:
```python
# extract_top_tweets.py の STEP 3と4の間に追加

# STEP 3.5: AI関連度フィルタリング（新規追加）
print("\n🤖 Filtering AI-related tweets...")
ai_filtered_tweets = filter_ai_relevance(filtered_tweets)  # スコア1点以上
ai_filtered_count = len(ai_filtered_tweets)

print(f"✅ AI-related tweets: {ai_filtered_count}/{filtered_count} ({ai_filtered_count/filtered_count*100:.1f}%)")
```

### Option B: filter-extracted-content スキルを作成

**メリット**:
- Phase 2.1の記事フィルタリングと統一
- 再利用性が高い

**デメリット**:
- 2段階処理になり、効率が悪い

---

## 📊 想定される改善効果

### 現在の状態（AI判定なし）

```
127ツイート → 124ツイート（著名人除外） → 10ツイート（TOP10）
AI関連率: 10%（10件中1件）
```

### 改善後（AI判定あり）

```
127ツイート → 124ツイート（著名人除外） → 50-70ツイート（AI関連1点以上） → 10ツイート（TOP10）
AI関連率: 100%（10件中10件）
```

---

## ✅ 次のアクション

### 優先順位

1. **高優先度**: `extract_top_tweets.py` にAI関連度判定を追加（Option A）
2. **中優先度**: AI判定後のTOP10再抽出とバリデーション
3. **低優先度**: Phase 2.1の `filter-extracted-content` スキルとの統合

### 実装手順

1. `ai_relevance_criteria.md` から3点/2点/1点キーワードリストを抽出
2. ツイートテキストとキーワードマッチング関数を実装
3. スコア1点以上のツイートのみ通過させる
4. テスト実行（2026-01-02タイムラインで検証）
5. TOP10再抽出 → AI関連率100%を確認

---

## 📝 補足

### なぜ10件中1件しかAI関連がないのか？

1. **エンゲージメント至上主義**: 内容に関わらず、エンゲージメントスコアが高いツイートが選出される
2. **Elon Musk周辺の政治・ビジネスツイート**: 非AI関連だが、エンゲージメントが非常に高い
3. **日本語の株式・投資ツイート**: エンゲージメントが高く、AI判定なしではフィルタされない

### Rank 10の「RAG」ツイートが唯一のAI関連

```json
{
  "username": "JapanTank",
  "text": "ここ数日RAGが話題だから専門家の一員として私見を述べるけど、RAGの本質的問題は検索技術がどうのとかいうものではないのよ...",
  "engagement_score": 952
}
```

- **スコア**: 3点（RAGキーワード明示）
- **エンゲージメント**: 952点（最低ラインギリギリ）
- **言語**: 日本語

このツイートのみがAI関連基準を満たしているが、他の9件は**エンゲージメントが高いだけで、AI関連度0点**。

---

## 結論

**TOP10にAI関連以外が含まれる根本原因**:

1. ❌ AI関連度フィルタリングが実装されていない
2. ✅ AI関連度判定基準は存在する（`.claude/skills/_shared/ai_relevance_criteria.md`）
3. ⚠️ `extract_top_tweets.py` はエンゲージメント抽出のみで、AI判定をスキップしている

**解決策**: `extract_top_tweets.py` の STEP 3.5に**AI関連度判定（1点以上）**を追加する。
