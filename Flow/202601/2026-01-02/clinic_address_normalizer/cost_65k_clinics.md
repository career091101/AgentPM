# 65,000医院（全国の歯科医院）データ処理コスト試算

## 前提条件

- **対象**: 全国の歯科医院 約65,000件
- **データ**: 医院名 + 都道府県（+ 市区町村）
- **Google Maps Platform 無料枠**: 月$200

---

## パターン別コスト試算

### パターンA: 5件候補取得（最も詳細）

#### コスト
```
1医院: $0.125
65,000医院: 65,000 × $0.125 = $8,125（約118万円）

無料枠適用後:
$8,125 - $200 = $7,925（約115万円の実費）
```

#### 無料枠だけで取得できる医院数
```
$200 / $0.125 = 1,600医院
```

**月1,600医院 × 12ヶ月 = 年間19,200医院まで無料**

---

### パターンB: 1件のみ取得（標準）

#### コスト
```
1医院: $0.057
65,000医院: 65,000 × $0.057 = $3,705（約54万円）

無料枠適用後:
$3,705 - $200 = $3,505（約51万円の実費）
```

#### 無料枠だけで取得できる医院数
```
$200 / $0.057 = 3,508医院
```

**月3,508医院 × 12ヶ月 = 年間42,096医院まで無料**

---

### パターンC: google_maps_url事前収集済み（最安）

#### コスト
```
1医院: $0.017（Place Detailsのみ）
65,000医院: 65,000 × $0.017 = $1,105（約16万円）

無料枠適用後:
$1,105 - $200 = $905（約13万円の実費）
```

#### 無料枠だけで取得できる医院数
```
$200 / $0.017 = 11,764医院
```

**月11,764医院 × 12ヶ月 = 年間141,168医院まで無料**（65,000件なら6ヶ月で完了）

---

## 推奨戦略：月次バッチ処理（完全無料）

### 戦略1: 1件のみ取得 × 19ヶ月（無料）

```
月3,500医院 × 19ヶ月 = 66,500医院
総コスト: $0（無料枠のみ）
期間: 19ヶ月（1年7ヶ月）
```

**メリット**:
- 完全無料
- 月次で自動実行可能
- エラーがあっても翌月リトライ可能

**デメリット**:
- 完了まで19ヶ月かかる

---

### 戦略2: 5件候補 × 41ヶ月（無料、ただし長期）

```
月1,600医院 × 41ヶ月 = 65,600医院
総コスト: $0（無料枠のみ）
期間: 41ヶ月（3年5ヶ月）
```

**メリット**:
- 完全無料
- 候補5件で精度が高い

**デメリット**:
- 完了まで3年以上かかる（現実的でない）

---

### 戦略3: 一括処理（有料、最速）

65,000医院を一括で処理する場合：

| 方式 | 総コスト | 実費（無料枠後） | 処理期間 |
|------|---------|----------------|---------|
| 5件候補 | $8,125（約118万円） | $7,925（約115万円） | 1週間 |
| 1件のみ | $3,705（約54万円） | $3,505（約51万円） | 1週間 |
| URL事前収集 | $1,105（約16万円） | $905（約13万円） | 1週間 |

---

## Google Maps APIで取得できる医院数

### 取得率の見込み

Google Mapsへの登録状況によって取得できる医院数が変わります：

| 医院タイプ | Google Maps登録率 | 取得可能数（推定） |
|-----------|------------------|------------------|
| **都市部の歯科医院** | 90〜95% | 58,500〜61,750件 |
| **地方の歯科医院** | 70〜80% | 45,500〜52,000件 |
| **全国平均** | 80〜90% | **52,000〜58,500件** |

**推定: 65,000件中、約52,000〜58,500件（80〜90%）が取得可能**

### 取得できない医院の例

- Google Mapsに未登録（特に高齢の開業医）
- 休業・廃業済み
- 検索クエリが不正確（誤字、古い情報）

---

## 最もコスパの良い方法

### 推奨: パターンB（1件のみ取得）× 月次バッチ処理

```
月3,500医院 × 19ヶ月 = 完全無料で66,500医院処理
```

#### 実行スケジュール

| 月 | 処理件数 | 累計 | コスト |
|----|---------|------|--------|
| 1ヶ月目 | 3,500件 | 3,500件 | $0 |
| 2ヶ月目 | 3,500件 | 7,000件 | $0 |
| 3ヶ月目 | 3,500件 | 10,500件 | $0 |
| ... | ... | ... | $0 |
| 18ヶ月目 | 3,500件 | 63,000件 | $0 |
| 19ヶ月目 | 2,000件 | 65,000件 | $0 |

**総コスト: $0（完全無料）**

---

## すぐに全件欲しい場合（有料）

### オプション1: 1件のみ取得で一括処理

```
総コスト: $3,705（約54万円）
無料枠後: $3,505（約51万円）
処理期間: 1週間
取得可能: 約52,000〜58,500件
```

### オプション2: URL事前収集 + 一括処理

**Step 1**: スクレイピングでgoogle_maps_urlを事前収集（別途開発）

**Step 2**: Place Details APIのみ実行
```
総コスト: $1,105（約16万円）
無料枠後: $905（約13万円）
処理期間: 3日
```

---

## コスト削減テクニック

### 1. 都道府県別に分割処理

月3,500件ずつ処理 → 完全無料

### 2. 重複削除

同じ医院が複数行ある場合、キャッシュ機能で削減

### 3. エラー再実行は最小限

検索クエリの精度を上げて、1回で成功率を高める

---

## 実際の運用シミュレーション

### ケース1: 月3,500件 × 19ヶ月（無料）

```
1ヶ月目: 東京都（約10,000件） → 3,500件処理
2ヶ月目: 東京都（残り6,500件） → 3,500件処理
3ヶ月目: 東京都（残り3,000件） → 3,000件処理
4ヶ月目: 大阪府（約3,500件） → 3,500件処理
...
19ヶ月目: 沖縄県（約500件） → 500件処理

総コスト: $0
```

### ケース2: 一括処理（1週間、約51万円）

```
Day 1-2: 30,000件処理
Day 3-4: 30,000件処理
Day 5-6: 5,000件処理 + エラー再処理
Day 7:   データ検証・手動レビュー

総コスト: 約51万円（無料枠$200適用後）
```

---

## まとめ

| 方式 | 取得可能数 | 期間 | コスト |
|------|-----------|------|--------|
| **月次バッチ（無料）** | 約52,000〜58,500件 | 19ヶ月 | **$0** |
| **一括処理（有料）** | 約52,000〜58,500件 | 1週間 | **約51万円** |
| **URL事前収集（有料）** | 約52,000〜58,500件 | 3日 | **約13万円** |

**推奨**: 急ぎでなければ月次バッチ処理で完全無料。急ぎなら一括処理で51万円。
