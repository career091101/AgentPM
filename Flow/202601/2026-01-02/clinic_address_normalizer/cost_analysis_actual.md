# 実際の抽出コスト分析

## 実行結果サマリー

- **最終出力件数**: 536件
- **実行クエリ数**: 90クエリ（45都府県 × 2診療科目）
- **取得生データ**: 約1,800件（90クエリ × 20件/クエリ）

## 使用API詳細

### 1. Places Text Search (New)
- **目的**: 各都府県×診療科目で歯科医院を検索
- **クエリ数**: 90クエリ
- **料金**: $0.032/request（Basic Data）
- **使用フィールド**:
  - places.id
  - places.displayName
  - places.formattedAddress
  - places.rating
  - places.userRatingCount
  - places.googleMapsUri
  - places.websiteUri
- **コスト**: 90 × $0.032 = **$2.88**

### 2. Place Details (New)
- **目的**: 郵便番号取得（addressComponents）
- **呼び出し回数**: 約1,800件（生データ全件）
- **料金**: $0.006/request（Contact Data - Address Components）
- **コスト**: 1,800 × $0.006 = **$10.80**

## 総コスト

### ドル建て
- **合計**: $2.88 + $10.80 = **$13.68**
- **1件あたり**: $13.68 ÷ 536件 = **$0.0255 ≈ $0.026**

### 円建て（1ドル = 150円換算）
- **合計**: $13.68 × 150 = **2,052円**
- **1件あたり**: $0.026 × 150 = **3.9円 ≈ 4円**

### 円建て（1ドル = 140円換算）
- **合計**: $13.68 × 140 = **1,915円**
- **1件あたり**: $0.026 × 140 = **3.6円**

## コスト内訳（1件あたり）

| 項目 | ドル | 円（150円/ドル） | 割合 |
|------|------|------------------|------|
| Text Search | $0.0054 | 0.81円 | 21% |
| Place Details | $0.0201 | 3.02円 | 79% |
| **合計** | **$0.0255** | **3.83円** | **100%** |

## 効率化の余地

### 現在の仕様
- 生データ1,800件すべてに対してPlace Details実行
- フィルタリング前にAPI呼び出し（非効率）

### 改善案
1. **フィルタリング後にPlace Details実行**
   - 現在: 1,800件 × $0.006 = $10.80
   - 改善後: 536件 × $0.006 = $3.22
   - **削減**: $7.58（70%コストカット）
   - **改善後1件あたり**: ($2.88 + $3.22) ÷ 536 = $0.0114 ≈ **1.7円**

2. **郵便番号をText Searchで取得**（可能な場合）
   - Place Detailsの呼び出しを完全に削減
   - ただし、住所の正規化精度は低下する可能性

## まとめ

### 現在のコスト
- **1件あたり**: $0.026（約4円）
- **536件合計**: $13.68（2,052円）

### 最適化後のコスト（推定）
- **1件あたり**: $0.011（約1.7円）
- **536件合計**: $6.10（915円）

### 無料枠との比較
- Google Maps Platform無料枠: $200/月
- 現在の方式: 7,692件/月まで無料
- 最適化後: 18,182件/月まで無料
